/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}



//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
 Last Modified Date: 07 -04 -2014
 Author: Anil
 Random Data Generator
 This script is for Greenplum database
 Prerequisite: Greenplum server should be created with following credentials
 Name: greenplum 
 Database: template1
     	1. Connect to server
	2. Exapnd "User Files" from tree node.
	3. Use "create_database_schema.sql" file to create database "project_employees" and create schema "test_user" .
     	4. Use Create_Table.sql file to create table

//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);



var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";      

                                       
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);

var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("Started inserting records ");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

       if (temp1 == "int8")
        datatype1[cnt] = "int8"; 
          else if (temp1 == "bigserial")
          datatype1[cnt] = "bigserial"; 
          else if (temp1 == "bool")
          datatype1[cnt] = "bool";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
          else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";
        else if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "path")
        datatype1[cnt] = "path";
        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "line")
        datatype1[cnt] = "line";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "time")
        datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "xml")
        datatype1[cnt] = "xml";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
      
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
    var data_pk = "@@@@";
    var data = "@@@@";
    var table_pk;

    var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
     table_pk = FK_Ref_PK[0].getTableName();
    col_fk = FK_Ref_PK[0].getName();

    data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

    data_fk = data_fk + data;
    while(data_fk.charAt(0) === '@')
    data_fk = data_fk.substr(1);                                               
    if (data.charAt(data.length - 1) == ',')
    {
    data = data.substr(0, data.length - 1);
    }

    funSecondary(table_pk, col_fk,data);

    chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
//aqua.console.println("stmt: "+stmt);
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================


conn.disconnect();

//Functions=====================================================================

function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
              var res = conn.executeUpdate(sql);
     }
     catch(e){
       aqua.console.println("exception: "+e);
     }
     return sql;
}



//==============
//Generation of random piece of data.

var today;
var today_date;
var time;
var zone1 ;

function random_string(size){
         var str2 = "";
         for (var i = 0; i < size; i++)
         str2 += random_character();
         return str2;
 }

 function random_character() {
        var chars = "abcdef0123456789";
        return chars.substr( Math.floor(Math.random() * 16), 1);
       }

function getDate(){
     today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();
     today_date = yyyy+"-"+mm+"-"+dd;
    return (today_date);
}

function getTime(){

        var hour =aqua.type.date.newDate().hours;
        var min = aqua.type.date.newDate().minutes;
        var sec = aqua.type.date.newDate().seconds;
         time = hour+":"+min+":"+sec;
         return(time);
}

function getZone(){
            zone1 = randomFromInterval(0,14);
            zone1 = pad(zone1,2);
           
            var zone2 = randomFromInterval(00,59);
            zone2 = pad(zone2,2);
            zone1 =zone1 + zone2 ;
         
            var r = randomFromInterval(0,1)
            if(r==0)
            zone1 = ("-"+zone1)
            else
            zone1 = ("+"+zone1)
            return(zone1);
}         

function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

function pad(num, size) {
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}

//Generation of random piece of data.
function generateRandomData(dataType,column)
{

var dataType = column.getDataType().toLowerCase();

// bigint and int8 datatypes for greenplum
 if (dataType == "int8"){
	return aqua.random.nextBigInteger(-9223372036854775808, 9223372036854775807);
 }

 else if (dataType == "bigserial"){
 	return aqua.random.nextBigInteger(1, 9223372036854775807);
 }

 else if (dataType == "bool"){
 	return (aqua.random.nextBoolean());
 }

 else if (dataType == "varchar" || dataType == "char" ){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if (dataType == "bytea" ){
        var len1 =  randomFromInterval(1,50);		
        return ("'"+aqua.random.nextString(len1)+"'");
 }

 else if (dataType == "bit"){
		
	var len = (column.getLength() == 0 ? 1 : column.getLength());
	var bit = "";

	for (var i=0; i<len; i++) { 
	     bit += randomFromInterval(0,1); 
	}
	
        var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
 }


 else if ( dataType == "numeric"){
 
        var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
	var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

        if ( precision - scale == 0 ){
           var num = aqua.random.nextFloat(); 
           var num= num.toFixed(scale);
           return num;
        }
        else{
           precision =  precision - scale ;
           return aqua.random.nextBigDecimal(1, precision, 0, scale);        
        }
        	
	}

 else if ( dataType == "int2"){
	return randomFromInterval(-32768, 32767);
 } 


 else if ( dataType == "int4"){
       return randomFromInterval(-2147483648, 2147483647);
 }

 else if ( dataType == "serial"){
       return randomFromInterval(1, 2147483647);
 }

   
 else if ( dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2=15;
                            
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if(dataType == "path"){
        var randomnumber1=randomFromInterval(-180, 180);
        var randomnumber2=randomFromInterval(-180, 180);
        var randomnumber3=randomFromInterval(-180, 180);
        var randomnumber4=randomFromInterval(-180, 180);
           
        var rg_path1 = "("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")";    
        return ("\'"+rg_path1+"\'");
 }    
  
 else if( dataType == "point"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        return ("\'("+randomnumber1+","+randomnumber2+")\'");
 } 

 else if (dataType == "circle"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var radius = randomFromInterval(1, 40);
        return ("\'(("+randomnumber1+","+randomnumber2+"),"+radius+")\'");
 }

 else if( dataType == "line" || dataType == "box" || dataType == "lseg"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+"\'");
 }
 
 else if( dataType == "polygon" ){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        var randomnumber5=randomFromInterval(-90, 90);
        var randomnumber6=randomFromInterval(-90, 90);

        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+",("+randomnumber5+","+randomnumber6+")"+"\'");

 }
         

 else if(dataType == "interval"){
              
        var year=randomFromInterval(-177999999,177999999);
        var month= randomFromInterval(0,11);
        var day=randomFromInterval(0,30);
        var hour=randomFromInterval(0,23);
        var min=randomFromInterval(0,59);
        var sec=randomFromInterval(0,59);
        var milisec=randomFromInterval(0,99);

        return ( "\'"+year+" years "+month+" mons "+day+" days "+hour+" hours "+ min +" mins "+sec+"."+milisec+" secs"+"\'" );
         
 }


 else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780228,340282346638528878701170114963097780228);
 }

 else if (dataType == "float8"){
	return randomFromInterval(-940282346638528878701170114963097780228677678678678678678,940282346638528878701170114963097780228677678678678678678);
 }

 else if(dataType == "cidr" || dataType == "inet"){
        var randomnumber1= randomFromInterval(127,192);
        var randomnumber2= randomFromInterval(10,192);
        var randomnumber3= randomFromInterval(0,255);
        var randomnumber4= randomFromInterval(0,255);

        return("\'"+ randomnumber1+"."+randomnumber2+"."+randomnumber3+"."+randomnumber4+"\'");    
 }

 else if(dataType == "money"){
   	var num = randomFromInterval(-21474836,21474836);
   	var scale = aqua.random.nextFloat(); 
  	scale= scale.toFixed(2);
   	var num = (+num) + (+scale);
  	num = "\'"+num+"\'";
   	return num;
 }

 else if(dataType == "varbit"){
       var range = randomFromInterval(1,50);
       var ans ="";
       for (var i = 0 ; i< range; i++){
           var num =  randomFromInterval(0,1);
           ans = ans + num;
       }
       return ("\'"+ans+"\'");
 }

 else if (dataType == "date"){
       
       today_date = getDate();
       return ("'"+today_date+"'");
 }

 else if (dataType == "time"){
       time = getTime();
      return ("'"+time+"'");
 } 

 else if (dataType == "timestamp"){
       today_date = getDate();
       time = getTime();
       return ("'"+today_date+" "+time+"'");      
 }
   
 else if (dataType == "timetz"){
       time = getTime();
       zone1 = getZone();
       return ("'"+time+" "+zone1+"'");
 }  

 else if (dataType == "timestamptz" ){
       today_date = getDate();
       time = getTime();
       zone1 = getZone();
       return ("'"+today_date+" "+time+" "+zone1+"'");  
 
 }

else if (dataType == "xml") { 
       return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
 }

else if (dataType == "macaddr"){
         var random_macaddr =random_string(12);
         return "\'"+random_macaddr+"\'";
 }

  return null;
}

 /*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:paraccel_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil Random Data Generator
 This script is for Paraccel database
 Prerequisite: Paraccel server should be created with following credentials
 Name: paraccel 
 Database: tickit
     1. Connect  to a server.
     2. Exapnd "User Files" from tree node.
     3. Use "paraccel_database_user_schema_group.sql" file to create database "paraccel" and open wallet for "paraccel" .
     4. Use CREATE_TABLE.sql file to create table.

------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  = 1;    //number of records to be inserted
var allowTimestamp           = true;  
var server                   = "ParAccelDB";
var database                 = "tickit"; 
var schema                   = "public";
                                           
var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println(" Connected to  New Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");

var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j=0; j<tablesArray.length; j++)
{

for (var st=0; st<maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "numeric")
        datatype1[cnt] = "numeric"; 
          else if (temp1 == "varchar")
          datatype1[cnt] = "varchar"; 
          else if (temp1 == "char")
          datatype1[cnt] = "char";

        else if (temp1 == "date")
        datatype1[cnt] = "date";

          else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "int2")
              datatype1[cnt] = "int2";
        else if (temp1 == "int4")
              datatype1[cnt] = "int4";
        else if (temp1 == "float4")
              datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
  
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
                var data_pk = "@@@@";
                var data = "@@@@";
                var table_pk;

                var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
                 table_pk = FK_Ref_PK[0].getTableName();
                col_fk = FK_Ref_PK[0].getName();

                             data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

                data_fk = data_fk + data;
                while(data_fk.charAt(0) === '@')
                data_fk = data_fk.substr(1);                                               
                if (data.charAt(data.length - 1) == ',')
                {
                data = data.substr(0, data.length - 1);
                }

                funSecondary(table_pk, col_fk,data);

                chkCons = "1";
}
}
index ++;
}// end of 1st while loop 
if(chkCons.equals("0")) 
{

        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 

}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
//aqua.console.println("stmt  "+stmt);

 var res2 = conn.executeScript(stmt);
var result = res2.results;
var count_value=0;
count_value = result[0].resultData[0].getValueAt(0,0);
aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+count_value);
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions======================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {

                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";

                                        }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
 var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
        var res = conn.executeUpdate(sql);
     }
     catch(e){
     aqua.console.println("exception: "+e);
     }
     return sql;
}


function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

//Generation of random piece of data.
function generateRandomData(dataType, column){

  var dataType = column.getDataType().toLowerCase();

   if ( dataType == "numeric"){
      var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
      var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

                if ( precision - scale == 0 ){
                     var num = aqua.random.nextFloat(); 
                     var num= num.toFixed(scale);
                     return num;
                }
                else{
                      precision =  precision - scale ;
                      return aqua.random.nextBigDecimal(1, precision, 0, scale);        
                }
        
   }
        
   else if (dataType == "varchar" || dataType == "char"){
                   var abc="a";
                             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
        }
        
   
   else if (dataType == "date" || dataType == "timestamp"){
        
       var today = new Date();
  
       var dd = today.getDate();
       var mm = today.getMonth()+1; //January is 0!
       var yyyy = today.getFullYear();
       var today_date = yyyy+'-'+mm+'-'+dd;
       if (dataType == "date"){
         return ("'"+today_date+"'");
       }
       else{
          var hour =aqua.type.date.newDate().hours;
          var min = aqua.type.date.newDate().minutes;
          var sec = aqua.type.date.newDate().seconds;
          return ("'"+today_date+" "+hour+":"+min+":"+sec+"'");
       }
   }

 
   else if (dataType == "bool"){
        return (aqua.random.nextBoolean());
   }

   else if (dataType == "int8"){
        return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
   }


   else if ( dataType == "int2"){
        return randomFromInterval(-32768, 32767);
   } 

   else if ( dataType == "int4"){
        return randomFromInterval(-2147483648, 2147483647);
   }

   else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780224,340282346638528878701170114963097780224);
   }

   else if (dataType == "float8"){
        return randomFromInterval(-34028234663852887870117011496309778022434746456,340282346638528878701170114963097780224454654353);
   }
        
    return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
Last Modified Date: 08 -04 -2014
Author: Anil
Random Data Generator
 This script is for Mysql database
 Prerequisite: Mysql server should be created with following credentials
 Name: mysql
 Database: sample
      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}



//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
 Last Modified Date: 07 -04 -2014
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);



var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";      

                                       
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);

var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("Started inserting records ");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

       if (temp1 == "int8")
        datatype1[cnt] = "int8"; 
          else if (temp1 == "bigserial")
          datatype1[cnt] = "bigserial"; 
          else if (temp1 == "bool")
          datatype1[cnt] = "bool";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
          else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";
        else if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "path")
        datatype1[cnt] = "path";
        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "line")
        datatype1[cnt] = "line";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "time")
        datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "xml")
        datatype1[cnt] = "xml";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
      
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
    var data_pk = "@@@@";
    var data = "@@@@";
    var table_pk;

    var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
     table_pk = FK_Ref_PK[0].getTableName();
    col_fk = FK_Ref_PK[0].getName();

    data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

    data_fk = data_fk + data;
    while(data_fk.charAt(0) === '@')
    data_fk = data_fk.substr(1);                                               
    if (data.charAt(data.length - 1) == ',')
    {
    data = data.substr(0, data.length - 1);
    }

    funSecondary(table_pk, col_fk,data);

    chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
//aqua.console.println("stmt: "+stmt);
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================


conn.disconnect();

//Functions=====================================================================

function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
              var res = conn.executeUpdate(sql);
     }
     catch(e){
       aqua.console.println("exception: "+e);
     }
     return sql;
}



//==============
//Generation of random piece of data.

var today;
var today_date;
var time;
var zone1 ;

function random_string(size){
         var str2 = "";
         for (var i = 0; i < size; i++)
         str2 += random_character();
         return str2;
 }

 function random_character() {
        var chars = "abcdef0123456789";
        return chars.substr( Math.floor(Math.random() * 16), 1);
       }

function getDate(){
     today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();
     today_date = yyyy+"-"+mm+"-"+dd;
    return (today_date);
}

function getTime(){

        var hour =aqua.type.date.newDate().hours;
        var min = aqua.type.date.newDate().minutes;
        var sec = aqua.type.date.newDate().seconds;
         time = hour+":"+min+":"+sec;
         return(time);
}

function getZone(){
            zone1 = randomFromInterval(0,14);
            zone1 = pad(zone1,2);
           
            var zone2 = randomFromInterval(00,59);
            zone2 = pad(zone2,2);
            zone1 =zone1 + zone2 ;
         
            var r = randomFromInterval(0,1)
            if(r==0)
            zone1 = ("-"+zone1)
            else
            zone1 = ("+"+zone1)
            return(zone1);
}         

function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

function pad(num, size) {
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}

//Generation of random piece of data.
function generateRandomData(dataType,column)
{

var dataType = column.getDataType().toLowerCase();

// bigint and int8 datatypes for greenplum
 if (dataType == "int8"){
	return aqua.random.nextBigInteger(-9223372036854775808, 9223372036854775807);
 }

 else if (dataType == "bigserial"){
 	return aqua.random.nextBigInteger(1, 9223372036854775807);
 }

 else if (dataType == "bool"){
 	return (aqua.random.nextBoolean());
 }

 else if (dataType == "varchar" || dataType == "char" ){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if (dataType == "bytea" ){
        var len1 =  randomFromInterval(1,50);		
        return ("'"+aqua.random.nextString(len1)+"'");
 }

 else if (dataType == "bit"){
		
	var len = (column.getLength() == 0 ? 1 : column.getLength());
	var bit = "";

	for (var i=0; i<len; i++) { 
	     bit += randomFromInterval(0,1); 
	}
	
        var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
 }


 else if ( dataType == "numeric"){
 
        var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
	var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

        if ( precision - scale == 0 ){
           var num = aqua.random.nextFloat(); 
           var num= num.toFixed(scale);
           return num;
        }
        else{
           precision =  precision - scale ;
           return aqua.random.nextBigDecimal(1, precision, 0, scale);        
        }
        	
	}

 else if ( dataType == "int2"){
	return randomFromInterval(-32768, 32767);
 } 


 else if ( dataType == "int4"){
       return randomFromInterval(-2147483648, 2147483647);
 }

 else if ( dataType == "serial"){
       return randomFromInterval(1, 2147483647);
 }

   
 else if ( dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2=15;
                            
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if(dataType == "path"){
        var randomnumber1=randomFromInterval(-180, 180);
        var randomnumber2=randomFromInterval(-180, 180);
        var randomnumber3=randomFromInterval(-180, 180);
        var randomnumber4=randomFromInterval(-180, 180);
           
        var rg_path1 = "("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")";    
        return ("\'"+rg_path1+"\'");
 }    
  
 else if( dataType == "point"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        return ("\'("+randomnumber1+","+randomnumber2+")\'");
 } 

 else if (dataType == "circle"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var radius = randomFromInterval(1, 40);
        return ("\'(("+randomnumber1+","+randomnumber2+"),"+radius+")\'");
 }

 else if( dataType == "line" || dataType == "box" || dataType == "lseg"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+"\'");
 }
 
 else if( dataType == "polygon" ){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        var randomnumber5=randomFromInterval(-90, 90);
        var randomnumber6=randomFromInterval(-90, 90);

        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+",("+randomnumber5+","+randomnumber6+")"+"\'");

 }
         

 else if(dataType == "interval"){
              
        var year=randomFromInterval(-177999999,177999999);
        var month= randomFromInterval(0,11);
        var day=randomFromInterval(0,30);
        var hour=randomFromInterval(0,23);
        var min=randomFromInterval(0,59);
        var sec=randomFromInterval(0,59);
        var milisec=randomFromInterval(0,99);

        return ( "\'"+year+" years "+month+" mons "+day+" days "+hour+" hours "+ min +" mins "+sec+"."+milisec+" secs"+"\'" );
         
 }


 else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780228,340282346638528878701170114963097780228);
 }

 else if (dataType == "float8"){
	return randomFromInterval(-940282346638528878701170114963097780228677678678678678678,940282346638528878701170114963097780228677678678678678678);
 }

 else if(dataType == "cidr" || dataType == "inet"){
        var randomnumber1= randomFromInterval(127,192);
        var randomnumber2= randomFromInterval(10,192);
        var randomnumber3= randomFromInterval(0,255);
        var randomnumber4= randomFromInterval(0,255);

        return("\'"+ randomnumber1+"."+randomnumber2+"."+randomnumber3+"."+randomnumber4+"\'");    
 }

 else if(dataType == "money"){
   	var num = randomFromInterval(-21474836,21474836);
   	var scale = aqua.random.nextFloat(); 
  	scale= scale.toFixed(2);
   	var num = (+num) + (+scale);
  	num = "\'"+num+"\'";
   	return num;
 }

 else if(dataType == "varbit"){
       var range = randomFromInterval(1,50);
       var ans ="";
       for (var i = 0 ; i< range; i++){
           var num =  randomFromInterval(0,1);
           ans = ans + num;
       }
       return ("\'"+ans+"\'");
 }

 else if (dataType == "date"){
       
       today_date = getDate();
       return ("'"+today_date+"'");
 }

 else if (dataType == "time"){
       time = getTime();
      return ("'"+time+"'");
 } 

 else if (dataType == "timestamp"){
       today_date = getDate();
       time = getTime();
       return ("'"+today_date+" "+time+"'");      
 }
   
 else if (dataType == "timetz"){
       time = getTime();
       zone1 = getZone();
       return ("'"+time+" "+zone1+"'");
 }  

 else if (dataType == "timestamptz" ){
       today_date = getDate();
       time = getTime();
       zone1 = getZone();
       return ("'"+today_date+" "+time+" "+zone1+"'");  
 
 }

else if (dataType == "xml") { 
       return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
 }

else if (dataType == "macaddr"){
         var random_macaddr =random_string(12);
         return "\'"+random_macaddr+"\'";
 }

  return null;
}

 /*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:paraccel_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil Random Data Generator
 This script is for Paraccel database
 Prerequisite: Paraccel server should be created with following credentials
 Name: paraccel 
 Database: tickit
     1. Connect  to a server.
     2. Exapnd "User Files" from tree node.
     3. Use "paraccel_database_user_schema_group.sql" file to create database "paraccel" and open wallet for "paraccel" .
     4. Use CREATE_TABLE.sql file to create table.

------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  = 1;    //number of records to be inserted
var allowTimestamp           = true;  
var server                   = "ParAccelDB";
var database                 = "tickit"; 
var schema                   = "public";
                                           
var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println(" Connected to  New Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");

var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j=0; j<tablesArray.length; j++)
{

for (var st=0; st<maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "numeric")
        datatype1[cnt] = "numeric"; 
          else if (temp1 == "varchar")
          datatype1[cnt] = "varchar"; 
          else if (temp1 == "char")
          datatype1[cnt] = "char";

        else if (temp1 == "date")
        datatype1[cnt] = "date";

          else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "int2")
              datatype1[cnt] = "int2";
        else if (temp1 == "int4")
              datatype1[cnt] = "int4";
        else if (temp1 == "float4")
              datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
  
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
                var data_pk = "@@@@";
                var data = "@@@@";
                var table_pk;

                var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
                 table_pk = FK_Ref_PK[0].getTableName();
                col_fk = FK_Ref_PK[0].getName();

                             data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

                data_fk = data_fk + data;
                while(data_fk.charAt(0) === '@')
                data_fk = data_fk.substr(1);                                               
                if (data.charAt(data.length - 1) == ',')
                {
                data = data.substr(0, data.length - 1);
                }

                funSecondary(table_pk, col_fk,data);

                chkCons = "1";
}
}
index ++;
}// end of 1st while loop 
if(chkCons.equals("0")) 
{

        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 

}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
//aqua.console.println("stmt  "+stmt);

 var res2 = conn.executeScript(stmt);
var result = res2.results;
var count_value=0;
count_value = result[0].resultData[0].getValueAt(0,0);
aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+count_value);
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions======================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {

                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";

                                        }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
 var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
        var res = conn.executeUpdate(sql);
     }
     catch(e){
     aqua.console.println("exception: "+e);
     }
     return sql;
}


function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

//Generation of random piece of data.
function generateRandomData(dataType, column){

  var dataType = column.getDataType().toLowerCase();

   if ( dataType == "numeric"){
      var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
      var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

                if ( precision - scale == 0 ){
                     var num = aqua.random.nextFloat(); 
                     var num= num.toFixed(scale);
                     return num;
                }
                else{
                      precision =  precision - scale ;
                      return aqua.random.nextBigDecimal(1, precision, 0, scale);        
                }
        
   }
        
   else if (dataType == "varchar" || dataType == "char"){
                   var abc="a";
                             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
        }
        
   
   else if (dataType == "date" || dataType == "timestamp"){
        
       var today = new Date();
  
       var dd = today.getDate();
       var mm = today.getMonth()+1; //January is 0!
       var yyyy = today.getFullYear();
       var today_date = yyyy+'-'+mm+'-'+dd;
       if (dataType == "date"){
         return ("'"+today_date+"'");
       }
       else{
          var hour =aqua.type.date.newDate().hours;
          var min = aqua.type.date.newDate().minutes;
          var sec = aqua.type.date.newDate().seconds;
          return ("'"+today_date+" "+hour+":"+min+":"+sec+"'");
       }
   }

 
   else if (dataType == "bool"){
        return (aqua.random.nextBoolean());
   }

   else if (dataType == "int8"){
        return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
   }


   else if ( dataType == "int2"){
        return randomFromInterval(-32768, 32767);
   } 

   else if ( dataType == "int4"){
        return randomFromInterval(-2147483648, 2147483647);
   }

   else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780224,340282346638528878701170114963097780224);
   }

   else if (dataType == "float8"){
        return randomFromInterval(-34028234663852887870117011496309778022434746456,340282346638528878701170114963097780224454654353);
   }
        
    return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
Last Modified Date: 08 -04 -2014
Author: Anil
Random Data Generator
 This script is for Mysql database
 Prerequisite: Mysql server should be created with following credentials
 Name: mysql
 Database: sample
      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}

//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();
                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//---------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
//---------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);
var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";    
                                     
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}



//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
 Last Modified Date: 07 -04 -2014
 Author: Anil
 Random Data Generator
 This script is for Greenplum database
 Prerequisite: Greenplum server should be created with following credentials
 Name: greenplum 
 Database: template1
     	1. Connect to server
	2. Exapnd "User Files" from tree node.
	3. Use "create_database_schema.sql" file to create database "project_employees" and create schema "test_user" .
     	4. Use Create_Table.sql file to create table

//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);



var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";      

                                       
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);

var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("Started inserting records ");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

       if (temp1 == "int8")
        datatype1[cnt] = "int8"; 
          else if (temp1 == "bigserial")
          datatype1[cnt] = "bigserial"; 
          else if (temp1 == "bool")
          datatype1[cnt] = "bool";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
          else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";
        else if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "path")
        datatype1[cnt] = "path";
        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "line")
        datatype1[cnt] = "line";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "time")
        datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "xml")
        datatype1[cnt] = "xml";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
      
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
    var data_pk = "@@@@";
    var data = "@@@@";
    var table_pk;

    var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
     table_pk = FK_Ref_PK[0].getTableName();
    col_fk = FK_Ref_PK[0].getName();

    data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

    data_fk = data_fk + data;
    while(data_fk.charAt(0) === '@')
    data_fk = data_fk.substr(1);                                               
    if (data.charAt(data.length - 1) == ',')
    {
    data = data.substr(0, data.length - 1);
    }

    funSecondary(table_pk, col_fk,data);

    chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
//aqua.console.println("stmt: "+stmt);
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================


conn.disconnect();

//Functions=====================================================================

function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
              var res = conn.executeUpdate(sql);
     }
     catch(e){
       aqua.console.println("exception: "+e);
     }
     return sql;
}



//==============
//Generation of random piece of data.

var today;
var today_date;
var time;
var zone1 ;

function random_string(size){
         var str2 = "";
         for (var i = 0; i < size; i++)
         str2 += random_character();
         return str2;
 }

 function random_character() {
        var chars = "abcdef0123456789";
        return chars.substr( Math.floor(Math.random() * 16), 1);
       }

function getDate(){
     today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();
     today_date = yyyy+"-"+mm+"-"+dd;
    return (today_date);
}

function getTime(){

        var hour =aqua.type.date.newDate().hours;
        var min = aqua.type.date.newDate().minutes;
        var sec = aqua.type.date.newDate().seconds;
         time = hour+":"+min+":"+sec;
         return(time);
}

function getZone(){
            zone1 = randomFromInterval(0,14);
            zone1 = pad(zone1,2);
           
            var zone2 = randomFromInterval(00,59);
            zone2 = pad(zone2,2);
            zone1 =zone1 + zone2 ;
         
            var r = randomFromInterval(0,1)
            if(r==0)
            zone1 = ("-"+zone1)
            else
            zone1 = ("+"+zone1)
            return(zone1);
}         

function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

function pad(num, size) {
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}

//Generation of random piece of data.
function generateRandomData(dataType,column)
{

var dataType = column.getDataType().toLowerCase();

// bigint and int8 datatypes for greenplum
 if (dataType == "int8"){
	return aqua.random.nextBigInteger(-9223372036854775808, 9223372036854775807);
 }

 else if (dataType == "bigserial"){
 	return aqua.random.nextBigInteger(1, 9223372036854775807);
 }

 else if (dataType == "bool"){
 	return (aqua.random.nextBoolean());
 }

 else if (dataType == "varchar" || dataType == "char" ){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if (dataType == "bytea" ){
        var len1 =  randomFromInterval(1,50);		
        return ("'"+aqua.random.nextString(len1)+"'");
 }

 else if (dataType == "bit"){
		
	var len = (column.getLength() == 0 ? 1 : column.getLength());
	var bit = "";

	for (var i=0; i<len; i++) { 
	     bit += randomFromInterval(0,1); 
	}
	
        var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
 }


 else if ( dataType == "numeric"){
 
        var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
	var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

        if ( precision - scale == 0 ){
           var num = aqua.random.nextFloat(); 
           var num= num.toFixed(scale);
           return num;
        }
        else{
           precision =  precision - scale ;
           return aqua.random.nextBigDecimal(1, precision, 0, scale);        
        }
        	
	}

 else if ( dataType == "int2"){
	return randomFromInterval(-32768, 32767);
 } 


 else if ( dataType == "int4"){
       return randomFromInterval(-2147483648, 2147483647);
 }

 else if ( dataType == "serial"){
       return randomFromInterval(1, 2147483647);
 }

   
 else if ( dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2=15;
                            
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if(dataType == "path"){
        var randomnumber1=randomFromInterval(-180, 180);
        var randomnumber2=randomFromInterval(-180, 180);
        var randomnumber3=randomFromInterval(-180, 180);
        var randomnumber4=randomFromInterval(-180, 180);
           
        var rg_path1 = "("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")";    
        return ("\'"+rg_path1+"\'");
 }    
  
 else if( dataType == "point"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        return ("\'("+randomnumber1+","+randomnumber2+")\'");
 } 

 else if (dataType == "circle"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var radius = randomFromInterval(1, 40);
        return ("\'(("+randomnumber1+","+randomnumber2+"),"+radius+")\'");
 }

 else if( dataType == "line" || dataType == "box" || dataType == "lseg"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+"\'");
 }
 
 else if( dataType == "polygon" ){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        var randomnumber5=randomFromInterval(-90, 90);
        var randomnumber6=randomFromInterval(-90, 90);

        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+",("+randomnumber5+","+randomnumber6+")"+"\'");

 }
         

 else if(dataType == "interval"){
              
        var year=randomFromInterval(-177999999,177999999);
        var month= randomFromInterval(0,11);
        var day=randomFromInterval(0,30);
        var hour=randomFromInterval(0,23);
        var min=randomFromInterval(0,59);
        var sec=randomFromInterval(0,59);
        var milisec=randomFromInterval(0,99);

        return ( "\'"+year+" years "+month+" mons "+day+" days "+hour+" hours "+ min +" mins "+sec+"."+milisec+" secs"+"\'" );
         
 }


 else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780228,340282346638528878701170114963097780228);
 }

 else if (dataType == "float8"){
	return randomFromInterval(-940282346638528878701170114963097780228677678678678678678,940282346638528878701170114963097780228677678678678678678);
 }

 else if(dataType == "cidr" || dataType == "inet"){
        var randomnumber1= randomFromInterval(127,192);
        var randomnumber2= randomFromInterval(10,192);
        var randomnumber3= randomFromInterval(0,255);
        var randomnumber4= randomFromInterval(0,255);

        return("\'"+ randomnumber1+"."+randomnumber2+"."+randomnumber3+"."+randomnumber4+"\'");    
 }

 else if(dataType == "money"){
   	var num = randomFromInterval(-21474836,21474836);
   	var scale = aqua.random.nextFloat(); 
  	scale= scale.toFixed(2);
   	var num = (+num) + (+scale);
  	num = "\'"+num+"\'";
   	return num;
 }

 else if(dataType == "varbit"){
       var range = randomFromInterval(1,50);
       var ans ="";
       for (var i = 0 ; i< range; i++){
           var num =  randomFromInterval(0,1);
           ans = ans + num;
       }
       return ("\'"+ans+"\'");
 }

 else if (dataType == "date"){
       
       today_date = getDate();
       return ("'"+today_date+"'");
 }

 else if (dataType == "time"){
       time = getTime();
      return ("'"+time+"'");
 } 

 else if (dataType == "timestamp"){
       today_date = getDate();
       time = getTime();
       return ("'"+today_date+" "+time+"'");      
 }
   
 else if (dataType == "timetz"){
       time = getTime();
       zone1 = getZone();
       return ("'"+time+" "+zone1+"'");
 }  

 else if (dataType == "timestamptz" ){
       today_date = getDate();
       time = getTime();
       zone1 = getZone();
       return ("'"+today_date+" "+time+" "+zone1+"'");  
 
 }

else if (dataType == "xml") { 
       return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
 }

else if (dataType == "macaddr"){
         var random_macaddr =random_string(12);
         return "\'"+random_macaddr+"\'";
 }

  return null;
}

 /*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:paraccel_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil Random Data Generator
 This script is for Paraccel database
 Prerequisite: Paraccel server should be created with following credentials
 Name: paraccel 
 Database: tickit
     1. Connect  to a server.
     2. Exapnd "User Files" from tree node.
     3. Use "paraccel_database_user_schema_group.sql" file to create database "paraccel" and open wallet for "paraccel" .
     4. Use CREATE_TABLE.sql file to create table.

------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  = 1;    //number of records to be inserted
var allowTimestamp           = true;  
var server                   = "ParAccelDB";
var database                 = "tickit"; 
var schema                   = "public";
                                           
var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println(" Connected to  New Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");

var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j=0; j<tablesArray.length; j++)
{

for (var st=0; st<maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "numeric")
        datatype1[cnt] = "numeric"; 
          else if (temp1 == "varchar")
          datatype1[cnt] = "varchar"; 
          else if (temp1 == "char")
          datatype1[cnt] = "char";

        else if (temp1 == "date")
        datatype1[cnt] = "date";

          else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "int2")
              datatype1[cnt] = "int2";
        else if (temp1 == "int4")
              datatype1[cnt] = "int4";
        else if (temp1 == "float4")
              datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
  
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
                var data_pk = "@@@@";
                var data = "@@@@";
                var table_pk;

                var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
                 table_pk = FK_Ref_PK[0].getTableName();
                col_fk = FK_Ref_PK[0].getName();

                             data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

                data_fk = data_fk + data;
                while(data_fk.charAt(0) === '@')
                data_fk = data_fk.substr(1);                                               
                if (data.charAt(data.length - 1) == ',')
                {
                data = data.substr(0, data.length - 1);
                }

                funSecondary(table_pk, col_fk,data);

                chkCons = "1";
}
}
index ++;
}// end of 1st while loop 
if(chkCons.equals("0")) 
{

        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 

}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
//aqua.console.println("stmt  "+stmt);

 var res2 = conn.executeScript(stmt);
var result = res2.results;
var count_value=0;
count_value = result[0].resultData[0].getValueAt(0,0);
aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+count_value);
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions======================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {

                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";

                                        }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
 var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
        var res = conn.executeUpdate(sql);
     }
     catch(e){
     aqua.console.println("exception: "+e);
     }
     return sql;
}


function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

//Generation of random piece of data.
function generateRandomData(dataType, column){

  var dataType = column.getDataType().toLowerCase();

   if ( dataType == "numeric"){
      var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
      var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

                if ( precision - scale == 0 ){
                     var num = aqua.random.nextFloat(); 
                     var num= num.toFixed(scale);
                     return num;
                }
                else{
                      precision =  precision - scale ;
                      return aqua.random.nextBigDecimal(1, precision, 0, scale);        
                }
        
   }
        
   else if (dataType == "varchar" || dataType == "char"){
                   var abc="a";
                             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
        }
        
   
   else if (dataType == "date" || dataType == "timestamp"){
        
       var today = new Date();
  
       var dd = today.getDate();
       var mm = today.getMonth()+1; //January is 0!
       var yyyy = today.getFullYear();
       var today_date = yyyy+'-'+mm+'-'+dd;
       if (dataType == "date"){
         return ("'"+today_date+"'");
       }
       else{
          var hour =aqua.type.date.newDate().hours;
          var min = aqua.type.date.newDate().minutes;
          var sec = aqua.type.date.newDate().seconds;
          return ("'"+today_date+" "+hour+":"+min+":"+sec+"'");
       }
   }

 
   else if (dataType == "bool"){
        return (aqua.random.nextBoolean());
   }

   else if (dataType == "int8"){
        return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
   }


   else if ( dataType == "int2"){
        return randomFromInterval(-32768, 32767);
   } 

   else if ( dataType == "int4"){
        return randomFromInterval(-2147483648, 2147483647);
   }

   else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780224,340282346638528878701170114963097780224);
   }

   else if (dataType == "float8"){
        return randomFromInterval(-34028234663852887870117011496309778022434746456,340282346638528878701170114963097780224454654353);
   }
        
    return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
Last Modified Date: 08 -04 -2014
Author: Anil
Random Data Generator
 This script is for Mysql database
 Prerequisite: Mysql server should be created with following credentials
 Name: mysql
 Database: sample
      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}



//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
 Last Modified Date: 07 -04 -2014
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);



var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";      

                                       
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);

var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("Started inserting records ");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

       if (temp1 == "int8")
        datatype1[cnt] = "int8"; 
          else if (temp1 == "bigserial")
          datatype1[cnt] = "bigserial"; 
          else if (temp1 == "bool")
          datatype1[cnt] = "bool";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
          else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";
        else if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "path")
        datatype1[cnt] = "path";
        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "line")
        datatype1[cnt] = "line";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "time")
        datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "xml")
        datatype1[cnt] = "xml";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
      
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
    var data_pk = "@@@@";
    var data = "@@@@";
    var table_pk;

    var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
     table_pk = FK_Ref_PK[0].getTableName();
    col_fk = FK_Ref_PK[0].getName();

    data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

    data_fk = data_fk + data;
    while(data_fk.charAt(0) === '@')
    data_fk = data_fk.substr(1);                                               
    if (data.charAt(data.length - 1) == ',')
    {
    data = data.substr(0, data.length - 1);
    }

    funSecondary(table_pk, col_fk,data);

    chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
//aqua.console.println("stmt: "+stmt);
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================


conn.disconnect();

//Functions=====================================================================

function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
              var res = conn.executeUpdate(sql);
     }
     catch(e){
       aqua.console.println("exception: "+e);
     }
     return sql;
}



//==============
//Generation of random piece of data.

var today;
var today_date;
var time;
var zone1 ;

function random_string(size){
         var str2 = "";
         for (var i = 0; i < size; i++)
         str2 += random_character();
         return str2;
 }

 function random_character() {
        var chars = "abcdef0123456789";
        return chars.substr( Math.floor(Math.random() * 16), 1);
       }

function getDate(){
     today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();
     today_date = yyyy+"-"+mm+"-"+dd;
    return (today_date);
}

function getTime(){

        var hour =aqua.type.date.newDate().hours;
        var min = aqua.type.date.newDate().minutes;
        var sec = aqua.type.date.newDate().seconds;
         time = hour+":"+min+":"+sec;
         return(time);
}

function getZone(){
            zone1 = randomFromInterval(0,14);
            zone1 = pad(zone1,2);
           
            var zone2 = randomFromInterval(00,59);
            zone2 = pad(zone2,2);
            zone1 =zone1 + zone2 ;
         
            var r = randomFromInterval(0,1)
            if(r==0)
            zone1 = ("-"+zone1)
            else
            zone1 = ("+"+zone1)
            return(zone1);
}         

function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

function pad(num, size) {
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}

//Generation of random piece of data.
function generateRandomData(dataType,column)
{

var dataType = column.getDataType().toLowerCase();

// bigint and int8 datatypes for greenplum
 if (dataType == "int8"){
	return aqua.random.nextBigInteger(-9223372036854775808, 9223372036854775807);
 }

 else if (dataType == "bigserial"){
 	return aqua.random.nextBigInteger(1, 9223372036854775807);
 }

 else if (dataType == "bool"){
 	return (aqua.random.nextBoolean());
 }

 else if (dataType == "varchar" || dataType == "char" ){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if (dataType == "bytea" ){
        var len1 =  randomFromInterval(1,50);		
        return ("'"+aqua.random.nextString(len1)+"'");
 }

 else if (dataType == "bit"){
		
	var len = (column.getLength() == 0 ? 1 : column.getLength());
	var bit = "";

	for (var i=0; i<len; i++) { 
	     bit += randomFromInterval(0,1); 
	}
	
        var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
 }


 else if ( dataType == "numeric"){
 
        var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
	var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

        if ( precision - scale == 0 ){
           var num = aqua.random.nextFloat(); 
           var num= num.toFixed(scale);
           return num;
        }
        else{
           precision =  precision - scale ;
           return aqua.random.nextBigDecimal(1, precision, 0, scale);        
        }
        	
	}

 else if ( dataType == "int2"){
	return randomFromInterval(-32768, 32767);
 } 


 else if ( dataType == "int4"){
       return randomFromInterval(-2147483648, 2147483647);
 }

 else if ( dataType == "serial"){
       return randomFromInterval(1, 2147483647);
 }

   
 else if ( dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2=15;
                            
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if(dataType == "path"){
        var randomnumber1=randomFromInterval(-180, 180);
        var randomnumber2=randomFromInterval(-180, 180);
        var randomnumber3=randomFromInterval(-180, 180);
        var randomnumber4=randomFromInterval(-180, 180);
           
        var rg_path1 = "("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")";    
        return ("\'"+rg_path1+"\'");
 }    
  
 else if( dataType == "point"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        return ("\'("+randomnumber1+","+randomnumber2+")\'");
 } 

 else if (dataType == "circle"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var radius = randomFromInterval(1, 40);
        return ("\'(("+randomnumber1+","+randomnumber2+"),"+radius+")\'");
 }

 else if( dataType == "line" || dataType == "box" || dataType == "lseg"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+"\'");
 }
 
 else if( dataType == "polygon" ){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        var randomnumber5=randomFromInterval(-90, 90);
        var randomnumber6=randomFromInterval(-90, 90);

        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+",("+randomnumber5+","+randomnumber6+")"+"\'");

 }
         

 else if(dataType == "interval"){
              
        var year=randomFromInterval(-177999999,177999999);
        var month= randomFromInterval(0,11);
        var day=randomFromInterval(0,30);
        var hour=randomFromInterval(0,23);
        var min=randomFromInterval(0,59);
        var sec=randomFromInterval(0,59);
        var milisec=randomFromInterval(0,99);

        return ( "\'"+year+" years "+month+" mons "+day+" days "+hour+" hours "+ min +" mins "+sec+"."+milisec+" secs"+"\'" );
         
 }


 else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780228,340282346638528878701170114963097780228);
 }

 else if (dataType == "float8"){
	return randomFromInterval(-940282346638528878701170114963097780228677678678678678678,940282346638528878701170114963097780228677678678678678678);
 }

 else if(dataType == "cidr" || dataType == "inet"){
        var randomnumber1= randomFromInterval(127,192);
        var randomnumber2= randomFromInterval(10,192);
        var randomnumber3= randomFromInterval(0,255);
        var randomnumber4= randomFromInterval(0,255);

        return("\'"+ randomnumber1+"."+randomnumber2+"."+randomnumber3+"."+randomnumber4+"\'");    
 }

 else if(dataType == "money"){
   	var num = randomFromInterval(-21474836,21474836);
   	var scale = aqua.random.nextFloat(); 
  	scale= scale.toFixed(2);
   	var num = (+num) + (+scale);
  	num = "\'"+num+"\'";
   	return num;
 }

 else if(dataType == "varbit"){
       var range = randomFromInterval(1,50);
       var ans ="";
       for (var i = 0 ; i< range; i++){
           var num =  randomFromInterval(0,1);
           ans = ans + num;
       }
       return ("\'"+ans+"\'");
 }

 else if (dataType == "date"){
       
       today_date = getDate();
       return ("'"+today_date+"'");
 }

 else if (dataType == "time"){
       time = getTime();
      return ("'"+time+"'");
 } 

 else if (dataType == "timestamp"){
       today_date = getDate();
       time = getTime();
       return ("'"+today_date+" "+time+"'");      
 }
   
 else if (dataType == "timetz"){
       time = getTime();
       zone1 = getZone();
       return ("'"+time+" "+zone1+"'");
 }  

 else if (dataType == "timestamptz" ){
       today_date = getDate();
       time = getTime();
       zone1 = getZone();
       return ("'"+today_date+" "+time+" "+zone1+"'");  
 
 }

else if (dataType == "xml") { 
       return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
 }

else if (dataType == "macaddr"){
         var random_macaddr =random_string(12);
         return "\'"+random_macaddr+"\'";
 }

  return null;
}

 /*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:paraccel_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil Random Data Generator
 This script is for Paraccel database
 Prerequisite: Paraccel server should be created with following credentials
 Name: paraccel 
 Database: tickit
     1. Connect  to a server.
     2. Exapnd "User Files" from tree node.
     3. Use "paraccel_database_user_schema_group.sql" file to create database "paraccel" and open wallet for "paraccel" .
     4. Use CREATE_TABLE.sql file to create table.

------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  = 1;    //number of records to be inserted
var allowTimestamp           = true;  
var server                   = "ParAccelDB";
var database                 = "tickit"; 
var schema                   = "public";
                                           
var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println(" Connected to  New Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");

var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j=0; j<tablesArray.length; j++)
{

for (var st=0; st<maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "numeric")
        datatype1[cnt] = "numeric"; 
          else if (temp1 == "varchar")
          datatype1[cnt] = "varchar"; 
          else if (temp1 == "char")
          datatype1[cnt] = "char";

        else if (temp1 == "date")
        datatype1[cnt] = "date";

          else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "int2")
              datatype1[cnt] = "int2";
        else if (temp1 == "int4")
              datatype1[cnt] = "int4";
        else if (temp1 == "float4")
              datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
  
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
                var data_pk = "@@@@";
                var data = "@@@@";
                var table_pk;

                var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
                 table_pk = FK_Ref_PK[0].getTableName();
                col_fk = FK_Ref_PK[0].getName();

                             data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

                data_fk = data_fk + data;
                while(data_fk.charAt(0) === '@')
                data_fk = data_fk.substr(1);                                               
                if (data.charAt(data.length - 1) == ',')
                {
                data = data.substr(0, data.length - 1);
                }

                funSecondary(table_pk, col_fk,data);

                chkCons = "1";
}
}
index ++;
}// end of 1st while loop 
if(chkCons.equals("0")) 
{

        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 

}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
//aqua.console.println("stmt  "+stmt);

 var res2 = conn.executeScript(stmt);
var result = res2.results;
var count_value=0;
count_value = result[0].resultData[0].getValueAt(0,0);
aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+count_value);
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions======================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {

                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";

                                        }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
 var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
        var res = conn.executeUpdate(sql);
     }
     catch(e){
     aqua.console.println("exception: "+e);
     }
     return sql;
}


function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

//Generation of random piece of data.
function generateRandomData(dataType, column){

  var dataType = column.getDataType().toLowerCase();

   if ( dataType == "numeric"){
      var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
      var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

                if ( precision - scale == 0 ){
                     var num = aqua.random.nextFloat(); 
                     var num= num.toFixed(scale);
                     return num;
                }
                else{
                      precision =  precision - scale ;
                      return aqua.random.nextBigDecimal(1, precision, 0, scale);        
                }
        
   }
        
   else if (dataType == "varchar" || dataType == "char"){
                   var abc="a";
                             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
        }
        
   
   else if (dataType == "date" || dataType == "timestamp"){
        
       var today = new Date();
  
       var dd = today.getDate();
       var mm = today.getMonth()+1; //January is 0!
       var yyyy = today.getFullYear();
       var today_date = yyyy+'-'+mm+'-'+dd;
       if (dataType == "date"){
         return ("'"+today_date+"'");
       }
       else{
          var hour =aqua.type.date.newDate().hours;
          var min = aqua.type.date.newDate().minutes;
          var sec = aqua.type.date.newDate().seconds;
          return ("'"+today_date+" "+hour+":"+min+":"+sec+"'");
       }
   }

 
   else if (dataType == "bool"){
        return (aqua.random.nextBoolean());
   }

   else if (dataType == "int8"){
        return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
   }


   else if ( dataType == "int2"){
        return randomFromInterval(-32768, 32767);
   } 

   else if ( dataType == "int4"){
        return randomFromInterval(-2147483648, 2147483647);
   }

   else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780224,340282346638528878701170114963097780224);
   }

   else if (dataType == "float8"){
        return randomFromInterval(-34028234663852887870117011496309778022434746456,340282346638528878701170114963097780224454654353);
   }
        
    return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
Last Modified Date: 08 -04 -2014
Author: Anil
Random Data Generator
 This script is for Mysql database
 Prerequisite: Mysql server should be created with following credentials
 Name: mysql
 Database: sample
      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}

//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();
                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//---------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
//---------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);
var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";    
                                     
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}



//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
 Last Modified Date: 07 -04 -2014
 Author: Anil
 Random Data Generator
 This script is for Greenplum database
 Prerequisite: Greenplum server should be created with following credentials
 Name: greenplum 
 Database: template1
     	1. Connect to server
	2. Exapnd "User Files" from tree node.
	3. Use "create_database_schema.sql" file to create database "project_employees" and create schema "test_user" .
     	4. Use Create_Table.sql file to create table

//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);



var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";      

                                       
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);

var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("Started inserting records ");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

       if (temp1 == "int8")
        datatype1[cnt] = "int8"; 
          else if (temp1 == "bigserial")
          datatype1[cnt] = "bigserial"; 
          else if (temp1 == "bool")
          datatype1[cnt] = "bool";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
          else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";
        else if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "path")
        datatype1[cnt] = "path";
        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "line")
        datatype1[cnt] = "line";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "time")
        datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "xml")
        datatype1[cnt] = "xml";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
      
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
    var data_pk = "@@@@";
    var data = "@@@@";
    var table_pk;

    var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
     table_pk = FK_Ref_PK[0].getTableName();
    col_fk = FK_Ref_PK[0].getName();

    data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

    data_fk = data_fk + data;
    while(data_fk.charAt(0) === '@')
    data_fk = data_fk.substr(1);                                               
    if (data.charAt(data.length - 1) == ',')
    {
    data = data.substr(0, data.length - 1);
    }

    funSecondary(table_pk, col_fk,data);

    chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
//aqua.console.println("stmt: "+stmt);
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================


conn.disconnect();

//Functions=====================================================================

function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
              var res = conn.executeUpdate(sql);
     }
     catch(e){
       aqua.console.println("exception: "+e);
     }
     return sql;
}



//==============
//Generation of random piece of data.

var today;
var today_date;
var time;
var zone1 ;

function random_string(size){
         var str2 = "";
         for (var i = 0; i < size; i++)
         str2 += random_character();
         return str2;
 }

 function random_character() {
        var chars = "abcdef0123456789";
        return chars.substr( Math.floor(Math.random() * 16), 1);
       }

function getDate(){
     today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();
     today_date = yyyy+"-"+mm+"-"+dd;
    return (today_date);
}

function getTime(){

        var hour =aqua.type.date.newDate().hours;
        var min = aqua.type.date.newDate().minutes;
        var sec = aqua.type.date.newDate().seconds;
         time = hour+":"+min+":"+sec;
         return(time);
}

function getZone(){
            zone1 = randomFromInterval(0,14);
            zone1 = pad(zone1,2);
           
            var zone2 = randomFromInterval(00,59);
            zone2 = pad(zone2,2);
            zone1 =zone1 + zone2 ;
         
            var r = randomFromInterval(0,1)
            if(r==0)
            zone1 = ("-"+zone1)
            else
            zone1 = ("+"+zone1)
            return(zone1);
}         

function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

function pad(num, size) {
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}

//Generation of random piece of data.
function generateRandomData(dataType,column)
{

var dataType = column.getDataType().toLowerCase();

// bigint and int8 datatypes for greenplum
 if (dataType == "int8"){
	return aqua.random.nextBigInteger(-9223372036854775808, 9223372036854775807);
 }

 else if (dataType == "bigserial"){
 	return aqua.random.nextBigInteger(1, 9223372036854775807);
 }

 else if (dataType == "bool"){
 	return (aqua.random.nextBoolean());
 }

 else if (dataType == "varchar" || dataType == "char" ){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if (dataType == "bytea" ){
        var len1 =  randomFromInterval(1,50);		
        return ("'"+aqua.random.nextString(len1)+"'");
 }

 else if (dataType == "bit"){
		
	var len = (column.getLength() == 0 ? 1 : column.getLength());
	var bit = "";

	for (var i=0; i<len; i++) { 
	     bit += randomFromInterval(0,1); 
	}
	
        var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
 }


 else if ( dataType == "numeric"){
 
        var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
	var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

        if ( precision - scale == 0 ){
           var num = aqua.random.nextFloat(); 
           var num= num.toFixed(scale);
           return num;
        }
        else{
           precision =  precision - scale ;
           return aqua.random.nextBigDecimal(1, precision, 0, scale);        
        }
        	
	}

 else if ( dataType == "int2"){
	return randomFromInterval(-32768, 32767);
 } 


 else if ( dataType == "int4"){
       return randomFromInterval(-2147483648, 2147483647);
 }

 else if ( dataType == "serial"){
       return randomFromInterval(1, 2147483647);
 }

   
 else if ( dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2=15;
                            
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if(dataType == "path"){
        var randomnumber1=randomFromInterval(-180, 180);
        var randomnumber2=randomFromInterval(-180, 180);
        var randomnumber3=randomFromInterval(-180, 180);
        var randomnumber4=randomFromInterval(-180, 180);
           
        var rg_path1 = "("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")";    
        return ("\'"+rg_path1+"\'");
 }    
  
 else if( dataType == "point"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        return ("\'("+randomnumber1+","+randomnumber2+")\'");
 } 

 else if (dataType == "circle"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var radius = randomFromInterval(1, 40);
        return ("\'(("+randomnumber1+","+randomnumber2+"),"+radius+")\'");
 }

 else if( dataType == "line" || dataType == "box" || dataType == "lseg"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+"\'");
 }
 
 else if( dataType == "polygon" ){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        var randomnumber5=randomFromInterval(-90, 90);
        var randomnumber6=randomFromInterval(-90, 90);

        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+",("+randomnumber5+","+randomnumber6+")"+"\'");

 }
         

 else if(dataType == "interval"){
              
        var year=randomFromInterval(-177999999,177999999);
        var month= randomFromInterval(0,11);
        var day=randomFromInterval(0,30);
        var hour=randomFromInterval(0,23);
        var min=randomFromInterval(0,59);
        var sec=randomFromInterval(0,59);
        var milisec=randomFromInterval(0,99);

        return ( "\'"+year+" years "+month+" mons "+day+" days "+hour+" hours "+ min +" mins "+sec+"."+milisec+" secs"+"\'" );
         
 }


 else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780228,340282346638528878701170114963097780228);
 }

 else if (dataType == "float8"){
	return randomFromInterval(-940282346638528878701170114963097780228677678678678678678,940282346638528878701170114963097780228677678678678678678);
 }

 else if(dataType == "cidr" || dataType == "inet"){
        var randomnumber1= randomFromInterval(127,192);
        var randomnumber2= randomFromInterval(10,192);
        var randomnumber3= randomFromInterval(0,255);
        var randomnumber4= randomFromInterval(0,255);

        return("\'"+ randomnumber1+"."+randomnumber2+"."+randomnumber3+"."+randomnumber4+"\'");    
 }

 else if(dataType == "money"){
   	var num = randomFromInterval(-21474836,21474836);
   	var scale = aqua.random.nextFloat(); 
  	scale= scale.toFixed(2);
   	var num = (+num) + (+scale);
  	num = "\'"+num+"\'";
   	return num;
 }

 else if(dataType == "varbit"){
       var range = randomFromInterval(1,50);
       var ans ="";
       for (var i = 0 ; i< range; i++){
           var num =  randomFromInterval(0,1);
           ans = ans + num;
       }
       return ("\'"+ans+"\'");
 }

 else if (dataType == "date"){
       
       today_date = getDate();
       return ("'"+today_date+"'");
 }

 else if (dataType == "time"){
       time = getTime();
      return ("'"+time+"'");
 } 

 else if (dataType == "timestamp"){
       today_date = getDate();
       time = getTime();
       return ("'"+today_date+" "+time+"'");      
 }
   
 else if (dataType == "timetz"){
       time = getTime();
       zone1 = getZone();
       return ("'"+time+" "+zone1+"'");
 }  

 else if (dataType == "timestamptz" ){
       today_date = getDate();
       time = getTime();
       zone1 = getZone();
       return ("'"+today_date+" "+time+" "+zone1+"'");  
 
 }

else if (dataType == "xml") { 
       return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
 }

else if (dataType == "macaddr"){
         var random_macaddr =random_string(12);
         return "\'"+random_macaddr+"\'";
 }

  return null;
}

 /*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:paraccel_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil Random Data Generator
 This script is for Paraccel database
 Prerequisite: Paraccel server should be created with following credentials
 Name: paraccel 
 Database: tickit
     1. Connect  to a server.
     2. Exapnd "User Files" from tree node.
     3. Use "paraccel_database_user_schema_group.sql" file to create database "paraccel" and open wallet for "paraccel" .
     4. Use CREATE_TABLE.sql file to create table.

------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  = 1;    //number of records to be inserted
var allowTimestamp           = true;  
var server                   = "ParAccelDB";
var database                 = "tickit"; 
var schema                   = "public";
                                           
var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println(" Connected to  New Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");

var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j=0; j<tablesArray.length; j++)
{

for (var st=0; st<maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "numeric")
        datatype1[cnt] = "numeric"; 
          else if (temp1 == "varchar")
          datatype1[cnt] = "varchar"; 
          else if (temp1 == "char")
          datatype1[cnt] = "char";

        else if (temp1 == "date")
        datatype1[cnt] = "date";

          else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "int2")
              datatype1[cnt] = "int2";
        else if (temp1 == "int4")
              datatype1[cnt] = "int4";
        else if (temp1 == "float4")
              datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
  
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
                var data_pk = "@@@@";
                var data = "@@@@";
                var table_pk;

                var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
                 table_pk = FK_Ref_PK[0].getTableName();
                col_fk = FK_Ref_PK[0].getName();

                             data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

                data_fk = data_fk + data;
                while(data_fk.charAt(0) === '@')
                data_fk = data_fk.substr(1);                                               
                if (data.charAt(data.length - 1) == ',')
                {
                data = data.substr(0, data.length - 1);
                }

                funSecondary(table_pk, col_fk,data);

                chkCons = "1";
}
}
index ++;
}// end of 1st while loop 
if(chkCons.equals("0")) 
{

        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 

}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
//aqua.console.println("stmt  "+stmt);

 var res2 = conn.executeScript(stmt);
var result = res2.results;
var count_value=0;
count_value = result[0].resultData[0].getValueAt(0,0);
aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+count_value);
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions======================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {

                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";

                                        }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
 var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
        var res = conn.executeUpdate(sql);
     }
     catch(e){
     aqua.console.println("exception: "+e);
     }
     return sql;
}


function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

//Generation of random piece of data.
function generateRandomData(dataType, column){

  var dataType = column.getDataType().toLowerCase();

   if ( dataType == "numeric"){
      var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
      var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

                if ( precision - scale == 0 ){
                     var num = aqua.random.nextFloat(); 
                     var num= num.toFixed(scale);
                     return num;
                }
                else{
                      precision =  precision - scale ;
                      return aqua.random.nextBigDecimal(1, precision, 0, scale);        
                }
        
   }
        
   else if (dataType == "varchar" || dataType == "char"){
                   var abc="a";
                             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
        }
        
   
   else if (dataType == "date" || dataType == "timestamp"){
        
       var today = new Date();
  
       var dd = today.getDate();
       var mm = today.getMonth()+1; //January is 0!
       var yyyy = today.getFullYear();
       var today_date = yyyy+'-'+mm+'-'+dd;
       if (dataType == "date"){
         return ("'"+today_date+"'");
       }
       else{
          var hour =aqua.type.date.newDate().hours;
          var min = aqua.type.date.newDate().minutes;
          var sec = aqua.type.date.newDate().seconds;
          return ("'"+today_date+" "+hour+":"+min+":"+sec+"'");
       }
   }

 
   else if (dataType == "bool"){
        return (aqua.random.nextBoolean());
   }

   else if (dataType == "int8"){
        return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
   }


   else if ( dataType == "int2"){
        return randomFromInterval(-32768, 32767);
   } 

   else if ( dataType == "int4"){
        return randomFromInterval(-2147483648, 2147483647);
   }

   else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780224,340282346638528878701170114963097780224);
   }

   else if (dataType == "float8"){
        return randomFromInterval(-34028234663852887870117011496309778022434746456,340282346638528878701170114963097780224454654353);
   }
        
    return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
Last Modified Date: 08 -04 -2014
Author: Anil
Random Data Generator
 This script is for Mysql database
 Prerequisite: Mysql server should be created with following credentials
 Name: mysql
 Database: sample
      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}



//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
 Last Modified Date: 07 -04 -2014
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);



var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";      

                                       
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);

var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("Started inserting records ");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

       if (temp1 == "int8")
        datatype1[cnt] = "int8"; 
          else if (temp1 == "bigserial")
          datatype1[cnt] = "bigserial"; 
          else if (temp1 == "bool")
          datatype1[cnt] = "bool";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
          else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";
        else if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "path")
        datatype1[cnt] = "path";
        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "line")
        datatype1[cnt] = "line";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "time")
        datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "xml")
        datatype1[cnt] = "xml";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
      
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
    var data_pk = "@@@@";
    var data = "@@@@";
    var table_pk;

    var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
     table_pk = FK_Ref_PK[0].getTableName();
    col_fk = FK_Ref_PK[0].getName();

    data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

    data_fk = data_fk + data;
    while(data_fk.charAt(0) === '@')
    data_fk = data_fk.substr(1);                                               
    if (data.charAt(data.length - 1) == ',')
    {
    data = data.substr(0, data.length - 1);
    }

    funSecondary(table_pk, col_fk,data);

    chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
//aqua.console.println("stmt: "+stmt);
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================


conn.disconnect();

//Functions=====================================================================

function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
              var res = conn.executeUpdate(sql);
     }
     catch(e){
       aqua.console.println("exception: "+e);
     }
     return sql;
}



//==============
//Generation of random piece of data.

var today;
var today_date;
var time;
var zone1 ;

function random_string(size){
         var str2 = "";
         for (var i = 0; i < size; i++)
         str2 += random_character();
         return str2;
 }

 function random_character() {
        var chars = "abcdef0123456789";
        return chars.substr( Math.floor(Math.random() * 16), 1);
       }

function getDate(){
     today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!
    var yyyy = today.getFullYear();
     today_date = yyyy+"-"+mm+"-"+dd;
    return (today_date);
}

function getTime(){

        var hour =aqua.type.date.newDate().hours;
        var min = aqua.type.date.newDate().minutes;
        var sec = aqua.type.date.newDate().seconds;
         time = hour+":"+min+":"+sec;
         return(time);
}

function getZone(){
            zone1 = randomFromInterval(0,14);
            zone1 = pad(zone1,2);
           
            var zone2 = randomFromInterval(00,59);
            zone2 = pad(zone2,2);
            zone1 =zone1 + zone2 ;
         
            var r = randomFromInterval(0,1)
            if(r==0)
            zone1 = ("-"+zone1)
            else
            zone1 = ("+"+zone1)
            return(zone1);
}         

function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

function pad(num, size) {
    var s = num+"";
    while (s.length < size) s = "0" + s;
    return s;
}

//Generation of random piece of data.
function generateRandomData(dataType,column)
{

var dataType = column.getDataType().toLowerCase();

// bigint and int8 datatypes for greenplum
 if (dataType == "int8"){
	return aqua.random.nextBigInteger(-9223372036854775808, 9223372036854775807);
 }

 else if (dataType == "bigserial"){
 	return aqua.random.nextBigInteger(1, 9223372036854775807);
 }

 else if (dataType == "bool"){
 	return (aqua.random.nextBoolean());
 }

 else if (dataType == "varchar" || dataType == "char" ){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if (dataType == "bytea" ){
        var len1 =  randomFromInterval(1,50);		
        return ("'"+aqua.random.nextString(len1)+"'");
 }

 else if (dataType == "bit"){
		
	var len = (column.getLength() == 0 ? 1 : column.getLength());
	var bit = "";

	for (var i=0; i<len; i++) { 
	     bit += randomFromInterval(0,1); 
	}
	
        var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
 }


 else if ( dataType == "numeric"){
 
        var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
	var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

        if ( precision - scale == 0 ){
           var num = aqua.random.nextFloat(); 
           var num= num.toFixed(scale);
           return num;
        }
        else{
           precision =  precision - scale ;
           return aqua.random.nextBigDecimal(1, precision, 0, scale);        
        }
        	
	}

 else if ( dataType == "int2"){
	return randomFromInterval(-32768, 32767);
 } 


 else if ( dataType == "int4"){
       return randomFromInterval(-2147483648, 2147483647);
 }

 else if ( dataType == "serial"){
       return randomFromInterval(1, 2147483647);
 }

   
 else if ( dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2=15;
                            
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

 else if(dataType == "path"){
        var randomnumber1=randomFromInterval(-180, 180);
        var randomnumber2=randomFromInterval(-180, 180);
        var randomnumber3=randomFromInterval(-180, 180);
        var randomnumber4=randomFromInterval(-180, 180);
           
        var rg_path1 = "("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")";    
        return ("\'"+rg_path1+"\'");
 }    
  
 else if( dataType == "point"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        return ("\'("+randomnumber1+","+randomnumber2+")\'");
 } 

 else if (dataType == "circle"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var radius = randomFromInterval(1, 40);
        return ("\'(("+randomnumber1+","+randomnumber2+"),"+radius+")\'");
 }

 else if( dataType == "line" || dataType == "box" || dataType == "lseg"){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+"\'");
 }
 
 else if( dataType == "polygon" ){
        var randomnumber1=randomFromInterval(-90, 90);
        var randomnumber2=randomFromInterval(-90, 90);
        var randomnumber3=randomFromInterval(-90, 90);
        var randomnumber4=randomFromInterval(-90, 90);
        var randomnumber5=randomFromInterval(-90, 90);
        var randomnumber6=randomFromInterval(-90, 90);

        return ("\'"+"("+randomnumber1+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber4+")"+",("+randomnumber5+","+randomnumber6+")"+"\'");

 }
         

 else if(dataType == "interval"){
              
        var year=randomFromInterval(-177999999,177999999);
        var month= randomFromInterval(0,11);
        var day=randomFromInterval(0,30);
        var hour=randomFromInterval(0,23);
        var min=randomFromInterval(0,59);
        var sec=randomFromInterval(0,59);
        var milisec=randomFromInterval(0,99);

        return ( "\'"+year+" years "+month+" mons "+day+" days "+hour+" hours "+ min +" mins "+sec+"."+milisec+" secs"+"\'" );
         
 }


 else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780228,340282346638528878701170114963097780228);
 }

 else if (dataType == "float8"){
	return randomFromInterval(-940282346638528878701170114963097780228677678678678678678,940282346638528878701170114963097780228677678678678678678);
 }

 else if(dataType == "cidr" || dataType == "inet"){
        var randomnumber1= randomFromInterval(127,192);
        var randomnumber2= randomFromInterval(10,192);
        var randomnumber3= randomFromInterval(0,255);
        var randomnumber4= randomFromInterval(0,255);

        return("\'"+ randomnumber1+"."+randomnumber2+"."+randomnumber3+"."+randomnumber4+"\'");    
 }

 else if(dataType == "money"){
   	var num = randomFromInterval(-21474836,21474836);
   	var scale = aqua.random.nextFloat(); 
  	scale= scale.toFixed(2);
   	var num = (+num) + (+scale);
  	num = "\'"+num+"\'";
   	return num;
 }

 else if(dataType == "varbit"){
       var range = randomFromInterval(1,50);
       var ans ="";
       for (var i = 0 ; i< range; i++){
           var num =  randomFromInterval(0,1);
           ans = ans + num;
       }
       return ("\'"+ans+"\'");
 }

 else if (dataType == "date"){
       
       today_date = getDate();
       return ("'"+today_date+"'");
 }

 else if (dataType == "time"){
       time = getTime();
      return ("'"+time+"'");
 } 

 else if (dataType == "timestamp"){
       today_date = getDate();
       time = getTime();
       return ("'"+today_date+" "+time+"'");      
 }
   
 else if (dataType == "timetz"){
       time = getTime();
       zone1 = getZone();
       return ("'"+time+" "+zone1+"'");
 }  

 else if (dataType == "timestamptz" ){
       today_date = getDate();
       time = getTime();
       zone1 = getZone();
       return ("'"+today_date+" "+time+" "+zone1+"'");  
 
 }

else if (dataType == "xml") { 
       return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
 }

else if (dataType == "macaddr"){
         var random_macaddr =random_string(12);
         return "\'"+random_macaddr+"\'";
 }

  return null;
}

 /*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:paraccel_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil Random Data Generator
 This script is for Paraccel database
 Prerequisite: Paraccel server should be created with following credentials
 Name: paraccel 
 Database: tickit
     1. Connect  to a server.
     2. Exapnd "User Files" from tree node.
     3. Use "paraccel_database_user_schema_group.sql" file to create database "paraccel" and open wallet for "paraccel" .
     4. Use CREATE_TABLE.sql file to create table.

------------------------------------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  = 1;    //number of records to be inserted
var allowTimestamp           = true;  
var server                   = "ParAccelDB";
var database                 = "tickit"; 
var schema                   = "public";
                                           
var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Currently connected to Database : "+curr_db);

conn.changeSchema(schema);                                                          
conn.changeDatabase(database);                                                         
var db_new= conn.currentDatabase;
aqua.console.println(" Connected to  New Database : "+db_new );

var metadata = conn.getMetadata();          
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");

var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j=0; j<tablesArray.length; j++)
{

for (var st=0; st<maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "numeric")
        datatype1[cnt] = "numeric"; 
          else if (temp1 == "varchar")
          datatype1[cnt] = "varchar"; 
          else if (temp1 == "char")
          datatype1[cnt] = "char";

        else if (temp1 == "date")
        datatype1[cnt] = "date";

          else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "int2")
              datatype1[cnt] = "int2";
        else if (temp1 == "int4")
              datatype1[cnt] = "int4";
        else if (temp1 == "float4")
              datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";
  
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
                var data_pk = "@@@@";
                var data = "@@@@";
                var table_pk;

                var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
                 table_pk = FK_Ref_PK[0].getTableName();
                col_fk = FK_Ref_PK[0].getName();

                             data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column

                data_fk = data_fk + data;
                while(data_fk.charAt(0) === '@')
                data_fk = data_fk.substr(1);                                               
                if (data.charAt(data.length - 1) == ',')
                {
                data = data.substr(0, data.length - 1);
                }

                funSecondary(table_pk, col_fk,data);

                chkCons = "1";
}
}
index ++;
}// end of 1st while loop 
if(chkCons.equals("0")) 
{

        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}

  var sqlScript = generateTableInsertScript(tableName, data_fk); 

}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
//aqua.console.println("stmt  "+stmt);

 var res2 = conn.executeScript(stmt);
var result = res2.results;
var count_value=0;
count_value = result[0].resultData[0].getValueAt(0,0);
aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+count_value);
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions======================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {

                                                 data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";

                                        }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
 var sql = " INSERT INTO "+" "+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
     try{
        var res = conn.executeUpdate(sql);
     }
     catch(e){
     aqua.console.println("exception: "+e);
     }
     return sql;
}


function randomFromInterval(from,to){

    var random = Math.random();
    var range = (to-from+1);
    var random_number = random * range + from;
    return Math.floor(random_number);
}

//Generation of random piece of data.
function generateRandomData(dataType, column){

  var dataType = column.getDataType().toLowerCase();

   if ( dataType == "numeric"){
      var precision = column.getPrecision() <= 38 ? column.getPrecision() : 38 ;
      var scale     = column.getScale() <= 37 ? column.getScale() : 37 ;

                if ( precision - scale == 0 ){
                     var num = aqua.random.nextFloat(); 
                     var num= num.toFixed(scale);
                     return num;
                }
                else{
                      precision =  precision - scale ;
                      return aqua.random.nextBigDecimal(1, precision, 0, scale);        
                }
        
   }
        
   else if (dataType == "varchar" || dataType == "char"){
                   var abc="a";
                             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
        }
        
   
   else if (dataType == "date" || dataType == "timestamp"){
        
       var today = new Date();
  
       var dd = today.getDate();
       var mm = today.getMonth()+1; //January is 0!
       var yyyy = today.getFullYear();
       var today_date = yyyy+'-'+mm+'-'+dd;
       if (dataType == "date"){
         return ("'"+today_date+"'");
       }
       else{
          var hour =aqua.type.date.newDate().hours;
          var min = aqua.type.date.newDate().minutes;
          var sec = aqua.type.date.newDate().seconds;
          return ("'"+today_date+" "+hour+":"+min+":"+sec+"'");
       }
   }

 
   else if (dataType == "bool"){
        return (aqua.random.nextBoolean());
   }

   else if (dataType == "int8"){
        return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
   }


   else if ( dataType == "int2"){
        return randomFromInterval(-32768, 32767);
   } 

   else if ( dataType == "int4"){
        return randomFromInterval(-2147483648, 2147483647);
   }

   else if (dataType == "float4"){   
        return randomFromInterval(-340282346638528878701170114963097780224,340282346638528878701170114963097780224);
   }

   else if (dataType == "float8"){
        return randomFromInterval(-34028234663852887870117011496309778022434746456,340282346638528878701170114963097780224454654353);
   }
        
    return null;
}
/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
File Name:postgres_v6.xjs
Last Modified Date: 07 -04 -2014
Author: Anil
Random Data Generator
 This script is for Postgres database
Prerequisite: postgres server should be created with following credentials
Name: postgres 
Database: test_project

      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table

This code will insert random data into the tables.

//---------------------------------------------------------------------------------------------
*/
importPackage(java.util); 


var maxRows                  =10;   //minimum number of rows to be inserted for each table.
var allowTimestamp           = true; 
var server                   =  "postgres";
var database                 =  "Test_DB"; 
var schema                   = "public";  //hardcoded

var all_conn = aqua.project.getServerConnections();
var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to : "+server);
aqua.console.println("Connected to Database : "+database);
var curr_db= conn.currentDatabase;
aqua.console.println("Current  Database : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase; 
conn.changeSchema(schema);

aqua.console.println("Now Connected to Database : "+db_new );
var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================

for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();

//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

         if (temp1 == "bit")
        datatype1[cnt] = "bit";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial"; 
        else if (temp1 == "binary")
        datatype1[cnt] = "binary"; 
        else if (temp1 == "bool")
        datatype1[cnt] = "bool";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "box")
        datatype1[cnt] = "box";
        else if (temp1 == "bytea")
        datatype1[cnt] = "bytea";

        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "character")
        datatype1[cnt] = "character";
        else if (temp1 == "clob")
        datatype1[cnt] = "clob"; 
        else if (temp1 == "circle")
        datatype1[cnt] = "circle";
        else if (temp1 == "cidr")
        datatype1[cnt] = "cidr";

        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal";

         else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "float4")
        datatype1[cnt] = "float4";
        else if (temp1 == "float8")
        datatype1[cnt] = "float8";

        else if (temp1 == "int")
        datatype1[cnt] = "int";
        else if (temp1 == "inet")
        datatype1[cnt] = "inet";
        else if (temp1 == "interval")
        datatype1[cnt] = "interval";
        else if (temp1 == "int2")
        datatype1[cnt] = "int2";
        else if (temp1 == "int4")
        datatype1[cnt] = "int4";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "json")
        datatype1[cnt] = "json";
        else if (temp1 == "long binary")
        datatype1[cnt] = "long binary"; 
        else if (temp1 == "lseg")
        datatype1[cnt] = "lseg";

        else if (temp1 == "mac")
        datatype1[cnt] = "mac";
        else if (temp1 == "macaddr")
        datatype1[cnt] = "macaddr";
        else if (temp1 == "money")
        datatype1[cnt] = "money";

        else if (temp1 == "numeric")
        datatype1[cnt] = "numeric";

        else if (temp1 == "path")
        datatype1[cnt] = "path";

        else if (temp1 == "oid")
        datatype1[cnt] = "oid";

        else if (temp1 == "point")
        datatype1[cnt] = "point";
        else if (temp1 == "polygon")
        datatype1[cnt] = "polygon";

        else if (temp1 == "smallserial")
        datatype1[cnt] = "smallserial"; 
        else if (temp1 == "serial")
        datatype1[cnt] = "serial"; 
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";

        else if (temp1 == "text")
        datatype1[cnt] = "text";
        else if (temp1 == "tsquery")
        datatype1[cnt] = "tsquery";
        else if (temp1 == "tsvector")
        datatype1[cnt] = "tsvector";
        else if (temp1 == "timestamp")
        datatype1[cnt] = "timestamp";
      else if (temp1 == "tinyint")
        datatype1[cnt] = "tinyint"; 
          else if (temp1 == "time")
          datatype1[cnt] = "time"; 
        else if (temp1 == "timetz")
        datatype1[cnt] = "timetz";
        else if (temp1 == "timestamptz")
        datatype1[cnt] = "timestamptz";
        else if (temp1 == "txid_snapshot")
        datatype1[cnt] = "txid_snapshot";

        else if (temp1 == "unichar")
        datatype1[cnt] = "unichar"; 
        else if (temp1 == "univarchar")
        datatype1[cnt] = "univarchar"; 
        else if (temp1 == "uuid")
        datatype1[cnt] = "uuid";

        else if (temp1 == "varbit")
        datatype1[cnt] = "varbit";
        else if (temp1 == "varbinary")
        datatype1[cnt] = "varbinary"; 
        else if (temp1 == "varbyte")
        datatype1[cnt] = "varbyte"; 
          else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";

        else if (temp1 == "xml")
        datatype1[cnt] = "xml";

   
}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data       = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +tablesArray[n].getName()+"\"";
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     

                                                  var column_name = tablesArray[j].extractColumns();

                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        { 
                                                        
                                                         if(column_name[c2].getName()==col_fk)                                 
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                        
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                           
                                                         }

                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                                     
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                      
                              }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);    
                   
                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO "+" "+"\"" +database+"\"" +"."+"\"" +schema+"\"" +"."+"\"" +table_name_x+"\""+" VALUES ( " + tabledata + ")" ;
       aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
     aqua.console.println("exception: "+e);

   }
return sql;
}


//===================================================
//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();


      if (dataType == "bit"){
		// since postgres has bits of more then 1 bit.
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bit = "B\'"+bit+"\'";
		return rg_bit;
	}
//B'101'
	 else if (dataType == "binary"){
        return aqua.random.nextInteger(1,32767);
	}
        else if (dataType == "bigint" ){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}

               else if(dataType == "bigserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_bigserial2 = "\'"+randomnumber1+"\'";
           return rg_bigserial2;
            }


            else if (dataType == "bool"){
         	var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_bool = bit;
		    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}
        else if (dataType == "boolean"){
                  var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) { 
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0"); 
		}
                    var rg_boolean= bit;
                    if (bit == 1){
                    return "TRUE";
                    }   
                      else  {
                    return "FALSE";
                    }  
	}

           else if (dataType == "bytea"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


        else if (dataType == "clob"){
              
                        var random_clob ="'E:\\images\\new.jpg'"
                    return random_clob;
         }
	

            else if (dataType == "character"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


         else if (dataType == "char"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                     function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

                            else if(dataType == "circle"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
             var randomnumber3=Math.floor(Math.random()*10);
             var randomnumber4=Math.floor(Math.random()*10);

           var rg_circle1 = "(("+randomnumber1+","+randomnumber1+")"+","+randomnumber4+")";    
           var rg_circle2 = "\'"+rg_circle1+"\'";
          return rg_circle2;
        }
//   '((1,1),4)'
                
             else if(dataType == "cidr"){
          var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_cidr2 = "\'"+rg_mac1+"\'";
           return rg_cidr2;
            }


	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm} 
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}


	else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	
	else if (dataType == "float"){
		return aqua.random.nextFloat();
	}

        else if (dataType == "float4"){
		return aqua.random.nextFloat();
	}
	else if (dataType == "float8"){
		return aqua.random.nextFloat();
	}

	//=========================================================================
	else if (dataType == "int"){
		return aqua.random.nextInteger(-2147483648, 2147483647);
	}


	//=========================================================================

                else if(dataType == "interval"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
            var randomnumber2= randomFromInterval(1,12);
             var randomnumber3=randomFromInterval(1,30);
             var randomnumber4=randomFromInterval(1,24);
             var randomnumber5=randomFromInterval(1,60);
             var randomnumber6=randomFromInterval(1,60);
             var randomnumber7=randomFromInterval(1,60);

                 
           var rg_interval1 =randomnumber1+" years "+randomnumber2+" mons "+randomnumber3+" days "+randomnumber4+" hours "+ randomnumber5 +" mins "+randomnumber6+"."+randomnumber6+" secs";    
           var rg_interval2 = "\'"+rg_interval1+"\'";
           return rg_interval2;
            }
// '1 years 0 mons 0 days 0 hours 10 mins 10.00 secs'


                             else if(dataType == "inet"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);
    
           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_inet2 = "\'"+rg_mac1+"\'";
           return rg_inet2;
            }

//  '192.168.1.150'

       

	// postgres
	else if (dataType == "int2"){
                                    function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(11, 99)
                               var rg_int2 = "\'"+rg_interval1+"\'";
		return rg_int2;
	}
	else if (dataType == "int4"){
                                               function randomFromInterval(from,to)
                    {
                        return Math.floor(Math.random()*(to-from+1)+from);
                    }
                               var rg_interval1= randomFromInterval(1111, 9999)
                               var rg_int4 = "\'"+rg_interval1+"\'";
		return rg_int4;
	}
	else if (dataType == "int8"){
		return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
	}


            else if (dataType == "long binary"){
        return aqua.random.nextInteger(1,32767);
	}

         	else if (dataType == "macaddr"){
                      
                            var rg_macadd = "\'08002b010203\'";
                              return rg_macadd;
                }
                      	
               
          else if(dataType == "money"){
                    return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
        }

   
         else if(dataType == "mac"){
            var randomnumber1=Math.floor(Math.random()*1000);
            var randomnumber2=Math.floor(Math.random()*100);
             var randomnumber3=Math.floor(Math.random()*100);
             var randomnumber4=Math.floor(Math.random()*100);

           var rg_mac1 ="1"+ randomnumber2+"."+"1"+randomnumber3+"."+"1"+"."+"1"+ randomnumber4;    
           var rg_mac2 = "\'"+rg_mac1+"\'";
           return rg_mac2;
            }


            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

	     
             else if(dataType == "path"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
    
           var rg_path1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_path2 = "\'"+rg_path1+"\'";

          return rg_path2;
        }

//'(7,7),(8,8),(9,9)'
              else if(dataType == "box"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_box1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_box2 = "\'"+rg_box1+"\'";
          return rg_box2;
        }
// '( ( 1 , 1 ) , ( 2 , 2 ) )'
             else if(dataType == "point"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*100);
    
           var rg_point1 = "("+randomnumber1+","+randomnumber1+")";    
           var rg_point2 = "\'"+rg_point1+"\'";
          return rg_point2;
        }
//  '(10,10)'
                
             else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*100);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*100);

           var rg_polygon1 = "("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+")"+","+"("+randomnumber3+","+randomnumber3+")";    
           var rg_polygon2 = "\'"+rg_polygon1+"\'";
          return rg_polygon2;
        }
//   '(11,11),(2,2),(13,13)'
 else if(dataType == "lseg"){
             var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
    
           var rg_lseg1 = "( ("+randomnumber1+","+randomnumber1+")"+","+"("+randomnumber2+","+randomnumber2+") )";    
           var rg_lseg2 = "\'"+rg_lseg1+"\'";
          return rg_lseg2;
            }
//   '((6,6),(7,7))'

 

              else if(dataType == "oid"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,5000);
            
                 
           var rg_oid1 =randomnumber1;    
           var rg_oid2 = "\'"+rg_oid1+"\'";
           return rg_oid2;
            }
//  '5678'

                    else if(dataType == "smallserial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_smallserial2 = "\'"+randomnumber1+"\'";
           return rg_smallserial2;
            }

                    else if(dataType == "serial"){
              function randomFromInterval(from,to)
                {
                      return Math.floor(Math.random()*(to-from+1)+from);
                }
             var randomnumber1=randomFromInterval(1,100);
                            
           var rg_serial2 = "\'"+randomnumber1+"\'";
           return rg_serial2;
            }



 else if (dataType == "smallint"){
		return aqua.random.nextInteger(-15000, 15000);
	}


	else if (dataType == "text"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}

        	else if (dataType == "json")
            {
                  var abc="a";
                  var abc = aqua.random.nextFirstName();
              //    aqua.console.println("\"{\"name\":"+"\""+abc+"\"}\"");
                  return abc ="'{"+"\"K1"+"\":"+"\""+abc+"\""+","+"\"k2"+"\":"+"\""+abc+"\""+"}'";
            }
             
        //  '{"k1": 1, "k2": "two"}'

            

        else if (dataType == "tinyint"){
		return aqua.random.nextInteger(0, 124);
	}
        else if (dataType == "time"){
                
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}
//          else if (dataType == "timetz"){ //2nd time
//                
//                var hour =aqua.type.date.newDate().hours;
//                var min = aqua.type.date.newDate().minutes;
//                var sec = aqua.type.date.newDate().seconds;
//                var data_timetz = "'"+hour+":"+min+":"+sec+"'";
//
//		return data_timetz;
//	}


else if (dataType == "timetz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
	else if (dataType == "timestamptz"){
		 var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
	}
//  "2013-12-06 18:36:39


      
           
            else if (dataType == "txid_snapshot"){
          
           var rg_txid1 = "\'"+'10:20:10,14,15'+"\'";
      //     var rg_txid1 = "\'"+'11:22:11,14,15'+"\'";
          return  rg_txid1;
          }
//  10:20:10,14,15



        else if (dataType == "timestamp"){
            var today1 = new Date();
            var dd1 = today1.getDate();
            var mm1 = today1.getMonth()+1; //January is 0!
            var yyyy1 = today1.getFullYear();
            if(dd1<10)
                {
                    dd1='0'+dd1
                } 
            if(mm1<10)
                {
                    mm1='0'+mm1
                 } 
                var today11 = yyyy1+'-'+mm1+'-'+dd1;
               
                var hour1 =aqua.type.date.newDate().hours;
                var min1 = aqua.type.date.newDate().minutes;
                var sec1 = aqua.type.date.newDate().seconds;
                var milisec1 = aqua.type.date.newDate().milliseconds;
                var time1 = hour1+":"+min1+":"+sec1;

                var r_datetime1 = "'"+today11+" "+time1+"'";
                return r_datetime1;
		//return  null;
	}


            else if (dataType == "tsquery"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                        var random_nvarchar =random_string(12);
                 return "\'"+random_nvarchar+"\'";
                }


                  else if (dataType == "tsvector"){
			function random_string(size){
                        var str2 = "";
                        for (var i = 0; i < size; i++){
                            str2 += random_character();
                        }
                        return str2;
                    }
                    function random_character() {
                        var chars = "abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ";
                        return chars.substr( Math.floor(Math.random() * 62), 1);
                    }
                         var random_nvarchar1 =random_string(7);
                        var random_nvarchar2 = "\'"+random_nvarchar1+"\'";

                 return random_nvarchar2;
                }


         else if (dataType == "unichar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}
	else if (dataType == "univarchar"){
		return aqua.random.nextUnicodeString(1, column.getLength());
	}



          else if (dataType == "uuid"){
            var rg_uuid1= aqua.random.nextGUID();
           var rg_uuid2 = "\'"+rg_uuid1+"\'";
          return  rg_uuid2;
          }



             

      else if (dataType == "varbit"){
		       var col_nvarchar_length2;
                var col_nvarchar_length  =column.getLength();
              //  aqua.console.println("=====varbit length: "+col_nvarchar_length)
                                if (col_nvarchar_length == 0)
                                    {
                                         col_nvarchar_length2 = 1
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                    digits = [0,1];
                                    var  len = col_nvarchar_length2;
                                      var   num = 0;
                                        while(len--)
                                          num = num * 10 + digits[Math.floor(Math.random() * digits.length)]
                                       //     aqua.console.println(num);
                    
                  var random_varbit =num;
                 return "\'"+random_varbit+"\'";
                }

        else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}


          else if (dataType == "varbinary"){
            var len = column.getLength();
            return aqua.random.nextInteger(1,32767);
	}

	else if (dataType == "varbyte"){
		//return aqua.random.nextString(1, column.getLength());
		var hex = "";
		var str = aqua.random.nextString(1, column.getLength());
		for (var i=0; i<str.length(); i++){
			hex += str.charCodeAt(i).toString(16);
		}
		return hex;
	}

        else if (dataType == "xml") { 
		return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>Aquafold Inc.</company></xml>\'";
                // return "\'<?xml version=\"1.0\" encoding=\"UTF-8\"?><xml><company>"+aqua.random.nextCompanyName()+"</company></xml>\'";

	}

    
	
	return null;
}
﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿﻿/*
//------------------------------------------------------------------------------------------------------------------------------------------------------------
 File Name:mysql_v6.xjs
Last Modified Date: 08 -04 -2014
Author: Anil
Random Data Generator
 This script is for Mysql database
 Prerequisite: Mysql server should be created with following credentials
 Name: mysql
 Database: sample
      1. Connect  to a server
      2. Use CREATE_TABLE.sql file from User Files folder of this project to create table
//------------------------------------------------------------------------------------------------------------------------------------------------------------
*/


importPackage(java.util);
//maximum number of rows to be inserted for each table.
var maxRows                 = 9;
var allowTimestamp           = true;
var server                   = "MySQL";
var database                 =  "performance_testing";
var schema                   = "";  //hardcoded

var all_conn = aqua.project.getserverconnections();
var conn = aqua.project.getserverconnection(server);
conn.connect();
aqua.console.println("you are connected to : "+server);
aqua.console.println("connected to database : "+database);
var metadata = conn.getmetadata();
var tablesarray   = metadata.extracttables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");
var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray;

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j = 0; j < tablesArray.length;  j++)
{
for (var st = 0; st < maxRows; st++)
{

aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";
var constraint_status = "0";

var column_name = tablesArray[j].extractColumns();
tableName             = tablesArray[j].getName();
constraintsArray    = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

        if (temp1 == "bigint")
             datatype1[cnt] = "bigint";
        else if (temp1 == "binary")
             datatype1[cnt] = "binary";
        else if (temp1 == "bit")
             datatype1[cnt] = "bit";
        else if (temp1 == "blob")
             datatype1[cnt] = "blob";
        else if (temp1 == "char")
             datatype1[cnt] = "char";
        else if (temp1 == "date")
             datatype1[cnt] = "date";
        else if (temp1 == "datetime")
             datatype1[cnt] = "datetime";
        else if (temp1 == "decimal")
             datatype1[cnt] = "decimal";
        else if (temp1 == "double")
             datatype1[cnt] = "double";
        else if (temp1 == "enum")
             datatype1[cnt] = "enum";
        else if (temp1 == "float")
             datatype1[cnt] = "float";
        else if (temp1 == "geometry")
             datatype1[cnt] = "geometry";
        else if (temp1 == "geometrycollection")
             datatype1[cnt] = "geometrycollection";
        else if (temp1 == "int")
             datatype1[cnt] = "int";
        else if (temp1 == "integer")
             datatype1[cnt] = "integer";
        else if (temp1 == "linestring")
             datatype1[cnt] = "linestring";
        else if (temp1 == "long")
             datatype1[cnt] = "long";
        else if (temp1 == "longblob")
             datatype1[cnt] = "longblob";
        else if (temp1 == "longtext")
             datatype1[cnt] = "longtext";
        else if (temp1 == "mediumblob")
             datatype1[cnt] = "mediumblob";
        else if (temp1 == "mediumint")
             datatype1[cnt] = "mediumint";
        else if (temp1 == "mediumtext")
             datatype1[cnt] = "mediumtext";
        else if (temp1 == "multipoint")
             datatype1[cnt] = "multipoint";
        else if (temp1 == "multilinestring")
             datatype1[cnt] = "multilinestring";
        else if (temp1 == "multipolygon")
             datatype1[cnt] = "multipolygon";
        else if (temp1 == "numeric")
             datatype1[cnt] = "numeric";
        else if (temp1 == "point")
             datatype1[cnt] = "point";
        else if (temp1 == "polygon")
             datatype1[cnt] = "polygon";
        else if (temp1 == "real")
             datatype1[cnt] = "real";
        else if (temp1 == "set")
             datatype1[cnt] = "set";
        else if (temp1 == "smallint")
             datatype1[cnt] = "smallint";
        else if (temp1 == "text")
             datatype1[cnt] = "text";
        else if (temp1 == "time")
             datatype1[cnt] = "time";
        else if (temp1 == "timestamp")
             datatype1[cnt] = "timestamp";
        else if (temp1 == "tinyblob")
             datatype1[cnt] = "tinyblob";
        else if (temp1 == "tinytext")
             datatype1[cnt] = "tinytext";
        else if (temp1 == "varbinary")
             datatype1[cnt] = "varbinary";
        else if (temp1 == "varchar")
             datatype1[cnt] = "varchar";
        else if (temp1 == "year")
             datatype1[cnt] = "year";
        else if (temp1 == "tinyint")
             datatype1[cnt] = "tinyint";


}
//===================================


for (var c2 = 0; c2 < column_name.length; c2++)
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();


if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName() == FK_ref[0].getName())
{
var data_pk = "@@@@";
var data       = "@@@@";
var table_pk;

var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
 table_pk = FK_Ref_PK[0].getTableName();
col_fk = FK_Ref_PK[0].getName();


data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
data_fk = data_fk + data;
while(data_fk.charAt(0) === '@')
data_fk = data_fk.substr(1);
if (data.charAt(data.length - 1) == ',')
{
data = data.substr(0, data.length - 1);
}

funSecondary(table_pk, col_fk,data);

chkCons = "1";
}
}
index ++;
}
if(chkCons.equals("0"))
{
      data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column
}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk);
}
}

aqua.console.println("\nFinished inserting records.");
aqua.console.println("");

//== code to get number of records inserted into tables=======================
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+database+"."+tablesArray[n].getName();

 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//==============================================================================


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================



conn.disconnect();

//Functions====================================================================
function funSecondary(table_pk, col_fk,data){

                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){

                                                  var column_name = tablesArray[j].extractColumns();
                                                  for (var c2=0; c2<column_name.length;c2++)
                                                        {
                                                             if(column_name[c2].getName()==col_fk)
                                                                {
                                                               data_pk = data_pk + data +"," ;
                                                                 }
                                                                 else
                                                            {
                                                                          data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                                            }
                                                         }
                                                                           data_pk = data_pk.substr(4, data_pk.length-2);
                                                                                 if (data_pk.charAt(data_pk.length - 1) == ',')
                                                                                    {
                                                                                     data_pk = data_pk.substr(0, data_pk.length - 1);
                                                                                    }
                                                        var sqlScript = generateTableInsertScript(table_pk, data_pk);
                                                    }
                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);

                    while(tabledata.charAt(0) === '@')
                        tabledata = tabledata.substr(1);


                    var tabledata = tabledata;
                    if (tabledata.charAt(tabledata.length - 1) == ',')
                    {
                       tabledata = tabledata.substr(0, tabledata.length - 1);
                     }
                        while(tabledata.charAt(0) === ',')
                        tabledata = tabledata.substr(1);


var sql = " INSERT INTO "+" "+database +"."+table_name_x+" values ( " + tabledata + ")" ;
        aqua.console.println("Insert script: " + sql);
   try{
        var res = conn.executeUpdate(sql);
    }
   catch(e ){
    aqua.console.println("exception: "+e);
   }
return sql;
}
//====================================

//===================================================
//Generation of random piece of data.
function generateRandomData(dataType,column)
{

             if (dataType == "bigint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,9223372036854775807)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }

         else if (dataType == "binary"){
       		return aqua.random.nextInteger(1, 80000);
	}
            else if (dataType == "bit"){
		var len = (column.getLength() == 0 ? 1 : column.getLength());
		var bit = "";
		for (var i=0; i<len; i++) {
			bit += (aqua.random.nextInteger(0,1) == 1 ? "1" : "0");
		}
		return bit;
	}

             else if(dataType == "blob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }



            else if (dataType == "char"){
                           var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


            else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}

            else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}if(mm<10){mm='0'+mm}
                var today = yyyy+'-'+mm+'-'+dd;

                 var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
               return r_datetime;
	}






        else if (dataType == "decimal"){
		var precision = column.getPrecision() <= 5 ? column.getPrecision() : 5;
		var scale     = column.getScale() <= 10 ? column.getScale() : 10;
		return aqua.random.nextBigDecimal(precision, precision, scale, scale);
	}



	else if (dataType == "double"){
		return aqua.random.nextDouble();
	}


	else if (dataType == "enum"){
		return "'G'";
	}

                else if (dataType == "float"){
		return aqua.random.nextFloat();
	}


                 else if(dataType == "geometry"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_geometry1 = randomnumber+" "+randomnumber;
           var rg_geometry2 = "GeomFromText('POINT ("+rg_geometry1+")')";

          return rg_geometry2;
        }
            else if(dataType == "geometrycollection"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

             var rg_geometrycollection1 = randomnumber1+" "+randomnumber1;
            var rg_geometrycollection2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
            var rg_geometrycollection3 = "GeomFromText('POINT ("+rg_geometrycollection1+")"+","+"LINESTRING("+rg_geometrycollection2+")')";

            return rg_geometrycollection3;
             }


           else if (dataType == "int")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,2147483647)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

             else if (dataType == "integer")
                    {
                        //function interval
                    function randomFromInterval(from,to)
                    {
                    return Math.floor(Math.random()*(to-from+1)+from);
                    }
                    var rg_interval1= randomFromInterval(1,15000)
                    var rg_interval2 = "\'"+rg_interval1+"\'";
                    return rg_interval2;
                    }

         else if(dataType == "linestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);

           var rg_linestring1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_linestring2 = "LineStringFromText('LINESTRING("+rg_linestring1+")')";

          return rg_linestring2;
        }
//LineStringFromText('LINESTRING(0 0,1 1,2 2)')

       else if (dataType == "long"){
            return aqua.random.nextLong();
	}

                else if(dataType == "longblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            	else if (dataType == "longtext"){
                    	 var abc="a";
		             var col_nvarchar_length2=15 ;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

            else if(dataType == "mediumblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }

            else if (dataType == "mediumint")
            {
                //function interval
            function randomFromInterval(from,to)
            {
            return Math.floor(Math.random()*(to-from+1)+from);
            }
            var rg_interval1= randomFromInterval(1,8388607)
            var rg_interval2 = "\'"+rg_interval1+"\'";
            return rg_interval2;
            }

         else if (dataType == "mediumtext"){
                               var abc="a";
		             var col_nvarchar_length2= 15;


                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}



            else if(dataType == "multipoint"){
              var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var rg_multipoint1 = randomnumber1+" "+randomnumber1;
           var rg_multipoint2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber5+" "+randomnumber5;
           var rg_multipoint3 = "PointFromText('POINT ("+rg_multipoint1+")"+","+"LINESTRING("+rg_multipoint2+")')";

          return rg_multipoint3;
        }
//INSERT INTO test23_multipoint(c23_multipoint)
//	VALUES(PointFromText('POINT (1 1),LINESTRING(8 8,6 6,8 8,1 1,1 1)'))
//GO


     else if(dataType == "multilinestring"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);


            var rg_multilinestring1 = randomnumber1+" "+randomnumber1;
           var rg_multilinestring2 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3;
           var rg_multilinestring3 = "LineStringFromText('Linestring("+rg_multilinestring1+")"+","+"LINESTRING("+rg_multilinestring2+")')";

          return rg_multilinestring3;
        }
//INSERT INTO test24_multilinestring(c24_multilinestring)
//	VALUES(LineStringFromText('LINESTRING(0 0),LINESTRING(0 0,1 1,2 2)'))
//GO


             else if(dataType == "multipolygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_multipolygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_multipolygon2 = "PolygonFromText("+"'POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+"),POLYGON(("+rg_multipolygon1+")"+","+"("+rg_multipolygon1+")"+")')";
           return rg_multipolygon2;
           }

            else if (dataType == "numeric"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else {
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}

        else if(dataType == "point"){
        var randomnumber=Math.floor(Math.random()*10);
           var rg_point1 = randomnumber+" "+randomnumber;
           var rg_point2 = "PointFromText('POINT ("+rg_point1+")')";

          return rg_point2;
        }
// SET @g = 'POINT(1 1)';
//INSERT INTO geom VALUES (PointFromText(@g))





          else if(dataType == "polygon"){
            var randomnumber1=Math.floor(Math.random()*10);
            var randomnumber2=Math.floor(Math.random()*10);
            var randomnumber3=Math.floor(Math.random()*10);
            var randomnumber4=Math.floor(Math.random()*10);
            var randomnumber5=Math.floor(Math.random()*10);

           var randomnumber=Math.floor(Math.random()*10);
           var rg_polygon1 = randomnumber1+" "+randomnumber1+","+randomnumber2+" "+randomnumber2+","+randomnumber3+" "+randomnumber3+","+randomnumber4+" "+randomnumber4+","+randomnumber1+" "+randomnumber1;
           var rg_polygon2 = "PolygonFromText("+"'POLYGON(("+rg_polygon1+")"+","+"("+rg_polygon1+")"+")')";
          return rg_polygon2;
        }

//SET @g = 'POLYGON((0 0,10 0,10 10,0 10,0 0),(5 5,7 5,7 7,5 7, 5 5))';
//    PolygonFromText(@g);
// insert into  db_anil1.test28_polygon values ( PolygonFromText('POLYGON((4 4,1 1,6 6,4 4,7 7),(4 4,1 1,6 6,4 4,7 7))'))

     else if (dataType == "real"){
		return aqua.random.nextFloat();
	}

             else if (dataType == "set"){
		return '1';
	}

            else if (dataType == "smallint")
                {
                    //function interval
                function randomFromInterval(from,to)
                {
                return Math.floor(Math.random()*(to-from+1)+from);
                }
                var rg_interval1= randomFromInterval(1,32767)
                var rg_interval2 = "\'"+rg_interval1+"\'";
                return rg_interval2;
                }



              else if (dataType == "text"){
                         var abc="a";
		             var col_nvarchar_length2=15 ;

                 function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

                 else if (dataType == "time"){

                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var data_time = "'"+hour+":"+min+":"+sec+"'";

		return data_time;
	}


                else if (dataType == "timestamp"){
		return  null;
	}

            else if(dataType == "tinyblob"){
                         var text = "a";
                                function makeid()
                     {
                        var possible = "abcdefghijklmnopqrstuvwxyz";

                         for( var i=0; i < 4; i++ )
                             text = possible.charAt(Math.floor(Math.random() * possible.length));
                    }
                     makeid();
                        var random_blob ="\""+"X"+"\'"+text+"\"";
                            return random_blob;
         }


            else if (dataType == "tinytext"){
                                    var abc="a";
		             var col_nvarchar_length2=15;

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}

             else if (dataType == "varbinary"){
       		return aqua.random.nextInteger(1, 80000);
	}


	else if (dataType == "varchar") {
                            var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 )
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }

                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                }
	}


    else if (dataType == "year"){
		if (column.getLength() == 4){
			return aqua.random.nextInteger(1901, 2155);
		}
		else if (column.getLength() == 2){
			return aqua.random.nextInteger(0, 99);
		}
		return 0;
	}

    else if (dataType == "tinyint")
{
	//function interval
function randomFromInterval(from,to)
{
return Math.floor(Math.random()*(to-from+1)+from);
}
var rg_interval1= randomFromInterval(1,127)
var rg_interval2 = "\'"+rg_interval1+"\'";
return rg_interval2;
}


	return null;
}
/*
//--------------------------------------------------------------------------------------------------------------------------------------------
File Name:Informix_v6.xjs
Last Modified Date: 11 -05 -2015
Author: Deepali
 Random Data Generator
 This script is for Informix database
 Prerequisite: Informix server should be created with following credentials
 Server Name: Informix12.10FC4 OR As per registered in your system but then user need to change servername at line21
 Database: db1_informix
 1. Connect to a server
 2. Use informix_create_table.sql file from User Files folder of this project to create table
 Note: For datatype blob,clob,byte,text are skipped in this script.
//---------------------------------------------------------------------------------------------------------------------------------------------
*/


var maxRows                = 10; //maximum number of rows to be inserted for each table.  
var allowTimestamp         = true; 
importPackage(java.util); 
var server                 = "Informix12.10FC4";
var database               =  "db_testing"; 
var schema                 = "informix"; 

var conn = aqua.project.getServerConnection(server);
conn.connect();
aqua.console.println("You are connected to Server : "+server);

var curr_db= conn.currentDatabase;
aqua.console.println("Your current Database is : "+curr_db);

conn.changeDatabase(database);
var db_new= conn.currentDatabase;
conn.changeSchema(schema);
aqua.console.println("New Connected to Database : "+db_new );

var metadata = conn.getMetadata();
var tablesArray   = metadata.extractTables(database, schema);

aqua.console.println("\nStarted inserting random data into tables");


var table_fk;
var hasRow   = false;
var tableName;
var constraintsArray; 

//====================Calculate total time required1============================
//Returns current time in milliseconds as reported by System.currentTimeMillis().
var startTime= aqua.system.getCurrentTime();
//==============================================================================


for (var j=0; j<tablesArray.length; j++)
{
for (var st=0; st<maxRows; st++)
{
aqua.console.println("\nTable Name: "+ tablesArray[j].getName());
var data_fk = "@@@@";

var constraint_status = "0";
  
var column_name = tablesArray[j].extractColumns();
tableName = tablesArray[j].getName();
constraintsArray = tablesArray[j].extractConstraints();


//=====Table columns datatype stored in a array========
var datatype1 = [];
for(var cnt = 0; cnt < column_name.length; cnt++)

{

    var temp1 = column_name[cnt].getDataType().toLowerCase();

    if (temp1 == "interval")
        datatype1[cnt] = "interval"; 
        else if (temp1 == "decimal")
        datatype1[cnt] = "decimal"; 
        else if (temp1 == "float")
        datatype1[cnt] = "float";
        else if (temp1 == "smallfloat")
        datatype1[cnt] = "smallfloat";
        else if (temp1 == "serial")
        datatype1[cnt] = "serial";
        else if (temp1 == "serial8")
        datatype1[cnt] = "serial8";
        else if (temp1 == "bigserial")
        datatype1[cnt] = "bigserial";
        else if (temp1 == "char")
        datatype1[cnt] = "char";
        else if (temp1 == "date")
        datatype1[cnt] = "date";
        else if (temp1 == "bigint")
        datatype1[cnt] = "bigint";
        else if (temp1 == "smallint")
        datatype1[cnt] = "smallint";
        else if (temp1 == "datetime")
        datatype1[cnt] = "datetime";
        else if (temp1 == "money")
        datatype1[cnt] = "money";
        else if (temp1 == "nchar")
        datatype1[cnt] = "nchar";
        else if (temp1 == "nvarchar")
        datatype1[cnt] = "nvarchar";
        else if (temp1 == "varchar")
        datatype1[cnt] = "varchar";
        else if (temp1 == "lvarchar")
        datatype1[cnt] = "lvarchar";
        else if (temp1 == "integer")
        datatype1[cnt] = "integer";
        else if (temp1 == "int8")
        datatype1[cnt] = "int8";
        else if (temp1 == "boolean")
        datatype1[cnt] = "boolean";
        else if (temp1 == "node")
        datatype1[cnt] = "node";
        else if (temp1 == "binary18")
        datatype1[cnt] = "binary18";
   
}
//===================================


for (var c2=0; c2<column_name.length;c2++) 
{
var index =0;
var chkCons = "0";

while(index < constraintsArray.length)
{
var FK_ref = constraintsArray[index].extractColumns();
 

if(constraintsArray[index].isForeignKeyConstraint())
{
if(column_name[c2].getName()==FK_ref[0].getName())                                 
{
        var data_pk = "@@@@";
        var data = "@@@@";
        var table_pk;

        var FK_Ref_PK = constraintsArray[index].extractForeignKeyRefColumns();
         table_pk = FK_Ref_PK[0].getTableName();
        col_fk = FK_Ref_PK[0].getName();

         data      =  generateRandomData(datatype1[c2],column_name[c2]) + ",";          // this will create data for primary column
        data_fk = data_fk + data;
        while(data_fk.charAt(0) === '@')
        data_fk = data_fk.substr(1);                                               
        if (data.charAt(data.length - 1) == ',')
        {
        data = data.substr(0, data.length - 1);
        }

        funSecondary(table_pk, col_fk,data);

        chkCons = "1";
}
}
index ++;
}// end of 1st while loop 

if(chkCons.equals("0")) 
{
        data_fk = data_fk + generateRandomData(datatype1[c2],column_name[c2]) + ",";            //this will create data for other column except primary column

}
}
  var sqlScript = generateTableInsertScript(tableName, data_fk); 
}
}
aqua.console.println(" ");

 aqua.console.println("Finished inserting records ");

aqua.console.println(" ");

//== code to get number of records inserted into tables
for(var n = 0; n< tablesArray.length; n++)
{
 var stmt = "select count(*) from "+"\"" +schema+"\""+"."+tablesArray[n].getName();
 var res2 = conn.executeScript(stmt);
var result = res2.results;
 aqua.console.println("Number of records in table "+ tablesArray[n].getName()+":"+result[0].resultData[0].getValueAt(0,0));
}
//============================================================================== 


//====================Calculate total time required2============================
var endTime= aqua.system.getCurrentTime();
var ms= endTime-startTime;

var seconds = (ms / 1000);
var minutes = ((ms / (1000*60)) % 60);
var hours   =  ((ms / (1000*60*60)) % 24);

aqua.console.print("\nTotal Time Required to insert "+ maxRows+ " records in "+tablesArray.length+" tables: ");
if(seconds<1){
ms=Math.round(ms*100)/100;
aqua.console.print(ms+ " milliseconds ");
}
else if(seconds>=1 && seconds<=60){
seconds=Math.round(seconds*100)/100;
aqua.console.print(seconds+ " seconds ");
}
else if(minutes>=1 && minutes<=60){
minutes=Math.round(minutes*100)/100;
aqua.console.print(minutes+ " minutes ");
}
else if(hours>=1){
hours=Math.round(hours*100)/100;
aqua.console.print(hours+ " hours ");
}
//==============================================================================

conn.disconnect();

//Functions=====================================================================
function funSecondary(table_pk, col_fk,data){
        
                  for (var j=0; j<tablesArray.length; j++)
                    {
                     if(table_pk == tablesArray[j].getName()){
                     
                               var column_name = tablesArray[j].extractColumns();

                                for (var c2=0; c2<column_name.length;c2++)
                                { 
                                                        
                                      if(column_name[c2].getName()==col_fk)                                 
                                      {
                                         data_pk = data_pk + data +"," ;
                                      }
                                      else
                                      {
                                       data_pk = data_pk + generateRandomData(datatype1[c2],column_name[c2]) + ",";
                                       }
                                 }

                                      data_pk = data_pk.substr(4, data_pk.length-2);
                                      if (data_pk.charAt(data_pk.length - 1) == ',')
                                      {
                                         data_pk = data_pk.substr(0, data_pk.length - 1);
                                      }
                                      var sqlScript = generateTableInsertScript(table_pk, data_pk);
                         }

                    }
}

function generateTableInsertScript(table_name_x, tabledata)
{
            var tabledata = tabledata;
            if (tabledata.charAt(tabledata.length - 1) == ',')
            {
                tabledata = tabledata.substr(0, tabledata.length - 1);
            }
            while(tabledata.charAt(0) === ',')
                 tabledata = tabledata.substr(1);    
                   
            while(tabledata.charAt(0) === '@')
                 tabledata = tabledata.substr(1);  
                                                                      
   
var sql = " INSERT INTO"+" "+"\""+schema+"\""+"."+table_name_x+" VALUES (" + tabledata + ")" ;

    aqua.console.println("Insert script: " + sql);
     try{
          var res = conn.executeUpdate(sql);
     }
     catch(e){
      aqua.console.println("exception: "+e);
     }
     return sql;
}

//************************************************************************************************
//This function is optional for nextInteger() function
function randomFromInterval(from,to)
{
    return Math.floor(Math.random()*(to-from+1)+from);
}

function generateRandomData(dataType,column)
{
	var dataType = column.getDataType().toLowerCase();

	if (dataType == "interval"){
            var today = new Date();
            var dd = today.getDate();
            var hour =aqua.type.date.newDate().hours;
            var min = aqua.type.date.newDate().minutes;
            var sec = aqua.type.date.newDate().seconds;
            var data_interval = "'"+dd+" "+hour+":"+min+":"+sec+"'";
		    return data_interval;
    }
    else if (dataType == "decimal"){
		if (column.getPrecision() == 0){
			return aqua.random.nextBigDecimal();
		}
		else{
			return aqua.random.nextBigDecimal(column.getPrecision(), column.getPrecision(), column.getScale(), column.getScale());
		}
	}
	else if (dataType == "float"){
		return aqua.random.nextFloat(-9998989794768686876876876868798955757,9998989794768686876876876868798955757);
	}
    else if (dataType == "smallfloat"){
		return aqua.random.nextFloat(-99445947686868768768768687989565789969,99445947686868768768768687989565789969);
	}
	//=========================================================================
	/* this function is substitute for nextInteger().Bcoz nextInteger() giving wrong o/p.
    else if (dataType == "int"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_int = randomFromInterval(-2147483647,2147483647);
        return data_int;
	}*/
    else if (dataType == "serial"){
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_serial = randomFromInterval(-2147483647,2147483647);
        return data_serial;
	}
    else if (dataType == "serial8"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
          //var data_serial8 = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_serial8;
    }
    else if (dataType == "bigserial"){
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigserial = randomFromInterval(-9223372036854775807,9223372036854775807);
         // return data_bigserial;
    }
    else if (dataType == "char"){
                    var abc = aqua.random.nextFirstName();
                      if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
              return "\'"+abc+"\'";
                 }
                 else
                {
              return "\'"+abc+"\'";
                } 
	}
	else if (dataType == "date"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!

            var yyyy = today.getFullYear();
            if(dd<10){
               dd='0'+dd
            }
            if(mm<10){
               mm='0'+mm
            } 
            var today = "'"+yyyy+'-'+mm+'-'+dd+"'";
            return today;
	}
	else if (dataType == "bigint" ){
		//return aqua.random.nextBigInteger(-923372036854775808, 923372036854775807);
		return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         // var data_bigint = randomFromInterval(-9223372036854775807,9223372036854775807);
          //return data_bigint;
	}
	else if (dataType == "smallint"){
		//return aqua.random.nextInteger(-15000, 15000);
		//return aqua.random.nextInteger(-32767, 32767);
        var data_smallint = randomFromInterval(-32767,32767);
        return data_smallint;
	}
    else if (dataType == "datetime"){
            var today = new Date();
            var dd = today.getDate();
            var mm = today.getMonth()+1; //January is 0!
            var yyyy = today.getFullYear();
            if(dd<10){dd='0'+dd}
            if(mm<10){mm='0'+mm} 
               var today = yyyy+'-'+mm+'-'+dd;
               
                var hour =aqua.type.date.newDate().hours;
                var min = aqua.type.date.newDate().minutes;
                var sec = aqua.type.date.newDate().seconds;
                var time = hour+":"+min+":"+sec

                var r_datetime = "'"+today+" "+time+"'";
                return r_datetime;
	}
	else if(dataType == "money"){
       //return aqua.random.nextDouble(-922337203685477.5808,922337203685477.5807);
       return aqua.random.nextDouble(-92238772387899.9809,92238772387899.9809);
    }
	else if (dataType == "nchar"){
                                var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "nvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "varchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();

                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "lvarchar"){
                   var abc="a";
		             var col_nvarchar_length2;
                             var col_nvarchar_length  =(column.getLength() > 25) ? 25 : column.getLength();
                                if (col_nvarchar_length == 0 || col_nvarchar_length == -1 ) 
                                    {
                                         col_nvarchar_length2 = 1;
                                     }
                                 else{
                                    col_nvarchar_length2 = col_nvarchar_length;
                                    }
                                     
                                function makeid()
                     {
                        var possible = aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                        +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName()
                                                    +" "+aqua.random.nextFirstName()+" "+aqua.random.nextFirstName();

                             abc = possible.slice(0,col_nvarchar_length2);
                             }
                              makeid();
                if (abc.search('\'') >=0)
                {
                abc=abc.replace('\'','')
                return abc = "'" + abc + "'";
                 }
                 else
                {
                return abc = "'" + abc + "'";
                } 
	}
    else if (dataType == "integer"){
		//return aqua.random.nextInteger(-147483647, 147483647);
		//return aqua.random.nextInteger(-2147483647, 2147483647);
        var data_integer = randomFromInterval(-2147483647,2147483647);
        return data_integer;
	}
	else if (dataType == "int8"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
           var data_int8 = randomFromInterval(-9223372036854775807,9223372036854775807);
           return data_int8;
	}
	else if (dataType == "boolean"){
		var data_bool = aqua.random.nextBoolean();
        if(data_bool == true){   
            var data_t = "t";
            return "'"+data_t+"'";
        }
        else if(data_bool == false){    
            var data_f = "f";
            return "'"+data_f+"'";
        }
	}
    else if (dataType == "node"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_node = aqua.random.nextBigInteger(1,1999999999);
         return "'"+data_node+"'";
	}
	else if (dataType == "binary18"){
		//return aqua.random.nextBigInteger(-9223372036854775807, 9223372036854775807);
         var data_binary18 = aqua.random.nextBigInteger(00,99);
         return "'"+data_binary18+"'";
	}
	return null;
}
/*
//---------------------------------------------------------------------------------------------------------------------------------
 File Name:greenplum_v6.xjs
//---------------------------------------------------------------------------------------------------------------------------------
*/
importPackage(java.util);
var maxRows                 = 500;     //Max. number of records
var allowTimestamp          = true;  
var server                  = "greenplum";
var database                = "gpadmin"; 
var schema                  = "public";    
                                     
var all_conn = aqua.project.getServerConnections();
aqua.console.list(all_conn);
var conn = aqua.project.getServerConnection(server);
conn.connect();                                                                     
aqua.console.println("You are connected to sever : "+server);
